--------------------------------------------------------
--  DDL for VW_ERLR_PERF_ISSUE
--------------------------------------------------------
CREATE OR REPLACE VIEW VW_ERLR_PERF_ISSUE
AS
SELECT
    PI.ERLR_CASE_NUMBER
    , EC.ERLR_JOB_REQ_NUMBER
    , EC.PROCID    
    , EC.ERLR_CASE_CREATE_DT
    , (SELECT L.TBL_LABEL FROM TBL_LOOKUP L WHERE L.TBL_ID = PI_ACTION_TYPE AND ROWNUM = 1) AS PI_ACTION_TYPE
	, PI_NEXT_WGI_DUE_DT
	, PI_PERF_COUNSEL_ISSUE_DT
	, CASE WHEN PI_CNSL_GRV_DECISION = '1'  THEN 'Yes' ELSE 'No' END AS PI_CNSL_GRV_DECISION
	, PI_DMTN_PRPS_ACTN_ISSUE_DT
	, CASE WHEN PI_DMTN_ORAL_PRSNT_REQ = '1'  THEN 'Yes' ELSE 'No' END AS PI_DMTN_ORAL_PRSNT_REQ
	, PI_DMTN_ORAL_PRSNT_DT
	, CASE WHEN PI_DMTN_WRTN_RESP_SBMT = '1'  THEN 'Yes' ELSE 'No' END AS PI_DMTN_WRTN_RESP_SBMT
	, PI_DMTN_WRTN_RESP_DUE_DT
	, PI_DMTN_WRTN_RESP_SBMT_DT
	, PI_DMTN_CUR_POS_TITLE
	, PI_DMTN_CUR_PAY_PLAN
	, PI_DMTN_CUR_JOB_SERIES
	, PI_DMTN_CUR_GRADE
	, PI_DMTN_CUR_STEP
	, PI_DMTN_PRPS_POS_TITLE
	, PI_DMTN_PRPS_PAY_PLAN
	, PI_DMTN_PRPS_JOB_SERIES
	, PI_DMTN_PRPS_GRADE
	, PI_DMTN_PRP_STEP
	, PI_DMTN_FIN_POS_TITLE
	, PI_DMTN_FIN_PAY_PLAN
	, PI_DMTN_FIN_JOB_SERIES
	, PI_DMTN_FIN_GRADE
	, PI_DMTN_FIN_STEP
	, (SELECT L.TBL_LABEL FROM TBL_LOOKUP L WHERE L.TBL_ID = PI_ACTION_TYPE AND ROWNUM = 1) AS PI_DMTN_FIN_AGCY_DECISION
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = PI_DMTN_FIN_DECIDING_OFC AND ROWNUM = 1)  AS PI_DMTN_FIN_DECIDING_OFC
	, PI_DMTN_FIN_DECISION_ISSUE_DT
	, PI_DMTN_DECISION_EFF_DT
	, CASE WHEN PI_DMTN_APPEAL_DECISION = '1'  THEN 'Yes' ELSE 'No' END AS PI_DMTN_APPEAL_DECISION
	, CASE WHEN PI_PIP_RSNBL_ACMDTN = '1'  THEN 'Yes' ELSE 'No' END AS PI_PIP_RSNBL_ACMDTN
	, CASE WHEN PI_PIP_EMPL_SBMT_MEDDOC = '1'  THEN 'Yes' ELSE 'No' END AS PI_PIP_EMPL_SBMT_MEDDOC
	, CASE WHEN PI_PIP_DOC_SBMT_FOH_RVW = '1'  THEN 'Yes' ELSE 'No' END AS PI_PIP_DOC_SBMT_FOH_RVW
	, CASE WHEN PI_PIP_WGI_WTHLD = '1'  THEN 'Yes' ELSE 'No' END AS PI_PIP_WGI_WTHLD
	, PI_PIP_WGI_RVW_DT
	, PI_PIP_MEDDOC_RVW_OUTCOME
	, PI_PIP_START_DT
	, PI_PIP_END_DT
	, PI_PIP_EXT_END_DT
	, PI_PIP_EXT_END_REASON
	, PI_PIP_EXT_END_NOTIFY_DT	
	, PI_PIP_ACTUAL_DT
	, CASE WHEN PI_PIP_END_PRIOR_TO_PLAN = '1'  THEN 'Yes' ELSE 'No' END AS PI_PIP_END_PRIOR_TO_PLAN
	, (SELECT L.TBL_LABEL FROM TBL_LOOKUP L WHERE L.TBL_ID = PI_PIP_END_PRIOR_TO_PLAN_RSN AND ROWNUM = 1) AS PI_PIP_END_PRIOR_TO_PLAN_RSN
	, CASE WHEN PI_PIP_SUCCESS_CMPLT = '1'  THEN 'Yes' ELSE 'No' END AS PI_PIP_SUCCESS_CMPLT
	, PI_PIP_PMAP_RTNG_SIGN_DT
	, PI_PIP_PMAP_RVW_SIGN_DT
	, (SELECT L.TBL_LABEL FROM TBL_LOOKUP L WHERE L.TBL_ID = PI_PIP_PRPS_ACTN AND ROWNUM = 1) AS PI_PIP_PRPS_ACTN
	, PI_PIP_PRPS_ISSUE_DT
	, CASE WHEN PI_PIP_ORAL_PRSNT_REQ = '1'  THEN 'Yes' ELSE 'No' END AS PI_PIP_ORAL_PRSNT_REQ
	, PI_PIP_ORAL_PRSNT_DT
	, CASE WHEN PI_PIP_WRTN_RESP_SBMT = '1'  THEN 'Yes' ELSE 'No' END AS PI_PIP_WRTN_RESP_SBMT
	, PI_PIP_WRTN_RESP_DUE_DT
	, PI_PIP_WRTN_SBMT_DT
	, (SELECT L.TBL_LABEL FROM TBL_LOOKUP L WHERE L.TBL_ID = PI_PIP_FIN_AGCY_DECISION AND ROWNUM = 1) AS PI_PIP_FIN_AGCY_DECISION
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = PI_PIP_DECIDING_OFFICAL AND ROWNUM = 1)  AS PI_PIP_DECIDING_OFFICAL
	, PI_PIP_FIN_AGCY_DECISION_DT
	, PI_PIP_DECISION_ISSUE_DT
	, PI_PIP_EFF_ACTN_DT
	, CASE WHEN PI_PIP_EMPL_GRIEVANCE = '1'  THEN 'Yes' ELSE 'No' END AS PI_PIP_EMPL_GRIEVANCE
	, CASE WHEN PI_PIP_APPEAL_DECISION = '1'  THEN 'Yes' ELSE 'No' END AS PI_PIP_APPEAL_DECISION
	, PI_REASGN_NOTICE_DT
	, PI_REASGN_EFF_DT
	, PI_REASGN_CUR_ADMIN_CD
	, PI_REASGN_CUR_ORG_NM
	, PI_REASGN_FIN_ADMIN_CD
	, PI_REASGN_FIN_ORG_NM
	, PI_RMV_PRPS_ACTN_ISSUE_DT
	, CASE WHEN PI_RMV_EMPL_NOTC_LEV = '1'  THEN 'Yes' ELSE 'No' END AS PI_RMV_EMPL_NOTC_LEV
	, PI_RMV_NOTC_LEV_START_DT
	, PI_RMV_NOTC_LEV_END_DT
	, CASE WHEN PI_RMV_ORAL_PRSNT_REQ = '1'  THEN 'Yes' ELSE 'No' END AS PI_RMV_ORAL_PRSNT_REQ
	, PI_RMV_ORAL_PRSNT_DT
	, PI_RMV_WRTN_RESP_DUE_DT
	, PI_RMV_WRTN_RESP_SBMT_DT
	, (SELECT L.TBL_LABEL FROM TBL_LOOKUP L WHERE L.TBL_ID = PI_RMV_FIN_AGCY_DECISION AND ROWNUM = 1) AS PI_RMV_FIN_AGCY_DECISION
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = PI_RMV_FIN_DECIDING_OFC AND ROWNUM = 1)  AS PI_RMV_FIN_DECIDING_OFC
	, PI_RMV_DECISION_ISSUE_DT
	, PI_RMV_EFF_DT
	, PI_RMV_NUM_DAYS
	, CASE WHEN PI_RMV_APPEAL_DECISION = '1'  THEN 'Yes' ELSE 'No' END AS PI_RMV_APPEAL_DECISION
	, (SELECT L.TBL_LABEL FROM TBL_LOOKUP L WHERE L.TBL_ID = PI_WRTN_NRTV_RVW_TYPE AND ROWNUM = 1) AS PI_WRTN_NRTV_RVW_TYPE
	, PI_WNR_SPCLST_RVW_CMPLT_DT
	, PI_WNR_MGR_RVW_RTNG_DT
	, PI_WNR_CRITICAL_ELM
	, PI_WNR_FIN_RATING
	, PI_WNR_RVW_OFC_CONCUR_DT
	, CASE WHEN PI_WNR_WGI_WTHLD = '1'  THEN 'Yes' ELSE 'No' END AS PI_WNR_WGI_WTHLD
	, PI_WNR_WGI_RVW_DT

FROM
	ERLR_PERF_ISSUE PI
    LEFT OUTER JOIN ERLR_CASE EC ON PI.ERLR_CASE_NUMBER = EC.ERLR_CASE_NUMBER
;
/