-- CMS_01_HR_VW_INCENTIVES_COM.sql
-- CMS_02_HR_VW_INCENTIVES_PDP.sql
-- CMS_20_HR_VW_ERLR_GEN.sql
-- CMS_21_HR_VW_RPT_ERLR_TRENDS.sql
-- CMS_26_HR_VW_INCENTIVES_PDP.sql
-- CMS_30_HR_VW_STRATCON.sql
-- CMS_31_HR_VW_CLASSIFICATION.sql
-- CMS_32_HR_VW_ELIGQUAL.sql
-- CMS_48_HR_VW_INCENTIVES_SAM.sql
-- CMS_54_HR_VW_INCENTIVES_LE.sql
-- CMS_55_HR_VW_INCENTIVES_LE_CRED.sql
-- CMS_61_HR_VW_INCENTIVES_PCA.sql
-- CMS_64_HR_VW_INCENTIVES_PDP.sql
-- CMS_66_HR_VW_INCENTIVES_COM.sql
-- CMS_84_HR_VW_STRATCON.sql
-- CMS_86_HR_VW_CLASSIFICATION.sql
-- CMS_92_HR_VW_INCENTIVES_PDP.sql
-- CMS_101_HR_VW_INCENATIVES_COM.sql
-- CMS_126_HR_VW_ERLR_PROB_ACTION.sql
-- CMS_126_HR_VW_FISCAL_CALENDAR.sql
-- CMS_152_HR_UPDATE_VW_ADMIN_CODE.sql
-- CMS_153_HR_VW_ERLR_APPEAL.sql
-- CMS_161_HR_VW_ERLR_GRIEVANCE.sql

SET DEFINE OFF;

-- SELECT * FROM VW_INCENTIVES_PDP2;
CREATE OR REPLACE FORCE VIEW HHS_CMS_HR.VW_INCENTIVES_COM (
        PROC_ID
        , INCEN_TYPE
        , REQ_NUM
        , REQ_TYPE
        , REQ_DATE
        , ADMIN_CODE
        , ORG_NAME
        , CANDI_NAME --Last, First Middle
        , CANDI_NAME2 --Last, First
        , CANDI_FIRST
        , CANDI_MIDDLE
        , CANDI_LAST
        , SO_NAME
        , SO_EMAIL
        , SO_ID
        , XO1_NAME
        , XO1_EMAIL
        , XO1_ID
        , XO2_NAME
        , XO2_EMAIL
        , XO2_ID
        , XO3_NAME
        , XO3_EMAIL
        , XO3_ID
        , HRL1_NAME
        , HRL1_EMAIL
        , HRL1_ID
        , HRL2_NAME
        , HRL2_EMAIL
        , HRL2_ID
        , HRL3_NAME
        , HRL3_EMAIL
        , HRL3_ID
        , HRS1_NAME
        , HRS1_EMAIL
        , HRS1_ID
        , HRS2_NAME
        , HRS2_EMAIL
        , HRS2_ID
        , DGHO_NAME
        , DGHO_EMAIL
        , DGHO_ID
        , TABG_NAME
        , TABG_EMAIL
        , TABG_ID
        , POS_TITLE
        , PAY_PLAN
        , SERIES
        , GRADE
        , POS_DESC_NUM
        , TYPE_OF_APPT
        , NOT_TO_EXCEED_DT
        , DS_STATE
        , DS_CITY
        , CANCEL_RESAON
        , CANCEL_USER_NAME
        , CANCEL_USER_ID
        , SO_TITLE
        , SS_NAME
        , SS_EMAIL
        , SS_ID
        , VACANCY_NUMBER
) AS 
SELECT 
        PROC_ID
        , INCEN_TYPE
        , REQ_NUM
        , REQ_TYPE
        , TO_CHAR(REQ_DATE, 'yyyy/mm/dd')
        , ADMIN_CODE
        , ORG_NAME
        , CANDI_NAME
        , CANDI_NAME2
        , CANDI_FIRST
        , CANDI_MIDDLE
        , CANDI_LAST
        , SO_NAME
        , SO_EMAIL
        , SO_ID
        , XO1_NAME
        , XO1_EMAIL
        , XO1_ID
        , XO2_NAME
        , XO2_EMAIL
        , XO2_ID
        , XO3_NAME
        , XO3_EMAIL
        , XO3_ID
        , HRL1_NAME
        , HRL1_EMAIL
        , HRL1_ID
        , HRL2_NAME
        , HRL2_EMAIL
        , HRL2_ID
        , HRL3_NAME
        , HRL3_EMAIL
        , HRL3_ID
        , HRS1_NAME
        , HRS1_EMAIL
        , HRS1_ID
        , HRS2_NAME
        , HRS2_EMAIL
        , HRS2_ID
        , DGHO_NAME
        , DGHO_EMAIL
        , DGHO_ID
        , TABG_NAME
        , TABG_EMAIL
        , TABG_ID
        , POS_TITLE
        , PAY_PLAN
        , SERIES
        , GRADE
        , POS_DESC_NUM
        , TYPE_OF_APPT
        , NOT_TO_EXCEED_DT
        , DS_STATE
        , DS_CITY
        , CANCEL_RESAON
        , CANCEL_USER_NAME
        , CANCEL_USER_ID
        , SO_TITLE
        , SS_NAME
        , SS_EMAIL
        , SS_ID
        , VACANCY_NUMBER
FROM HHS_CMS_HR.INCENTIVES_COM
;
/

CREATE OR REPLACE FORCE VIEW HHS_CMS_HR.VW_INCENTIVES_PDP (
     PROC_ID
    , PDP_TYPE
    , PDP_TYPE_OTHER
    , EXISTINGREQUEST
    , WORK_SCHEDULE
    , HOURS_PER_WEEK
    , BD_CERT_REQ
    , LIC_INFO
    , MARKET_PAY_RATE
    , CURRENT_FED_EMPLOYEE
    , LEVEL_RESPONSIBILITY
    , EXEC_RESP_AMT_REQUESTED
    , EXEC_RESP_JUSTIF_DETERMIN_AMT
    , EXPT_QF_Q1_AMT_REQUESTED
    , EXPT_QF_Q1_JUSTIF_DETERMIN_AMT
    , EXPT_QF_Q2_AMT_REQUESTED
    , EXPT_QF_Q2_JUSTIF_DETERMIN_AMT
    , EXPT_QF_Q3_AMT_REQUESTED
    , EXPT_QF_Q3_JUSTIF_DETERMIN_AMT
    , EXPT_QF_Q4_AMT_REQUESTED
    , EXPT_QF_Q4_JUSTIF_DETERMIN_AMT
    , EXPT_QF_Q5_AMT_REQUESTED
    , EXPT_QF_Q5_JUSTIF_DETERMIN_AMT
    , TOTAL_AMT_EXPT_QUALIFICATIONS
    , CURRENT_PAY_GRADE
    , CURRENT_PAY_STEP
    , CURRENT_PAY_POSITION_TITLE
    , CURRENT_PAY_TABLE
    , CURRENT_PAY_TIER
    , CLINICAL_SPECIALTY_BOARD_CERT
    , OTHER_SPECIALTY
    , CURRENT_PAY_RECRUITMENT
    , CURRENT_PAY_RELOCATION
    , CURRENT_PAY_RETENTION
    , CURRENT_PAY_3R_TOTAL
    , CURRENT_PAY_BASE
    , CURRENT_PAY_LOCALITY_MARKET
    , CURRENT_PAY_TOTAL_ANNUAL_PAY
    , CURRENT_PAY_TOTAL_COMPENSATION
    , CURRENT_PAY_NOTES
    , PROPOSED_PAY_STEP
    , PROPOSED_PAY_TABLE
    , PROPOSED_PAY_TIER
    , PROPOSED_PAY_RECRUITMENT
    , PROPOSED_PAY_RELOCATION
    , PROPOSED_PAY_RETENTION
    , PROPOSED_PAY_TOTAL_3R
    , PROPOSED_GS_BASE_PAY
    , PROPOSED_MARKET_PAY
    , PROPOSED_TOTAL_ANNUAL_PAY
    , PROPOSED_TOTAL_ANNUAL_COMPENS
    , INCENTIVES_APPROVED_BY_TABG
    , PROPOSED_PAY_NOTES
    , DATE_OF_MEETING
    , QUORUM_REACHED
    , PANEL_CURRENT_SALARY
    , PANEL_PDP_AMOUNT
    , PANEL_RECOMM_ANNUAL_SALARY
    , SELECTING_OFFICIAL_REVIEWER
    , SELECTING_OFFICIAL_REVIEW_DT
    , TABG_DIVISION_DIR_REVIEW_DT
    , CMS_CHIEF_PHYSICIAN_REVIEW_DT
    , OFM_REVIEW_DATE
    , TABG_REVIEW_DATE
    , OHC_REVIEW_DATE
    , ADMINISTRATOR_APPROVAL_DATE
    , DATE_OF_RECOMMENDATION
) AS 
SELECT 
     PROC_ID
    , PDP_TYPE
    , PDP_TYPE_OTHER
    , EXISTINGREQUEST
    , WORK_SCHEDULE
    , HOURS_PER_WEEK
    , BD_CERT_REQ
    , LIC_INFO
    , MARKET_PAY_RATE
    , CURRENT_FED_EMPLOYEE
    , LEVEL_RESPONSIBILITY
    , EXEC_RESP_AMT_REQUESTED
    , EXEC_RESP_JUSTIF_DETERMIN_AMT
    , EXPT_QF_Q1_AMT_REQUESTED
    , EXPT_QF_Q1_JUSTIF_DETERMIN_AMT
    , EXPT_QF_Q2_AMT_REQUESTED
    , EXPT_QF_Q2_JUSTIF_DETERMIN_AMT
    , EXPT_QF_Q3_AMT_REQUESTED
    , EXPT_QF_Q3_JUSTIF_DETERMIN_AMT
    , EXPT_QF_Q4_AMT_REQUESTED
    , EXPT_QF_Q4_JUSTIF_DETERMIN_AMT
    , EXPT_QF_Q5_AMT_REQUESTED
    , EXPT_QF_Q5_JUSTIF_DETERMIN_AMT
    , TOTAL_AMT_EXPT_QUALIFICATIONS
    , CURRENT_PAY_GRADE
    , CURRENT_PAY_STEP
    , CURRENT_PAY_POSITION_TITLE
    , CURRENT_PAY_TABLE
    , CURRENT_PAY_TIER
    , CLINICAL_SPECIALTY_BOARD_CERT
    , OTHER_SPECIALTY
    , CURRENT_PAY_RECRUITMENT
    , CURRENT_PAY_RELOCATION
    , CURRENT_PAY_RETENTION
    , CURRENT_PAY_3R_TOTAL
    , CURRENT_PAY_BASE
    , CURRENT_PAY_LOCALITY_MARKET
    , CURRENT_PAY_TOTAL_ANNUAL_PAY
    , CURRENT_PAY_TOTAL_COMPENSATION
    , CURRENT_PAY_NOTES
    , PROPOSED_PAY_STEP
    , PROPOSED_PAY_TABLE
    , PROPOSED_PAY_TIER
    , PROPOSED_PAY_RECRUITMENT
    , PROPOSED_PAY_RELOCATION
    , PROPOSED_PAY_RETENTION
    , PROPOSED_PAY_TOTAL_3R
    , PROPOSED_GS_BASE_PAY
    , PROPOSED_MARKET_PAY
    , PROPOSED_TOTAL_ANNUAL_PAY
    , PROPOSED_TOTAL_ANNUAL_COMPENS
    , INCENTIVES_APPROVED_BY_TABG
    , PROPOSED_PAY_NOTES
    , DATE_OF_MEETING
    , QUORUM_REACHED
    , PANEL_CURRENT_SALARY
    , PANEL_PDP_AMOUNT
    , PANEL_RECOMM_ANNUAL_SALARY
    , SELECTING_OFFICIAL_REVIEWER
    , SELECTING_OFFICIAL_REVIEW_DT
    , TABG_DIVISION_DIR_REVIEW_DT
    , CMS_CHIEF_PHYSICIAN_REVIEW_DT
    , OFM_REVIEW_DATE
    , TABG_REVIEW_DATE
    , OHC_REVIEW_DATE
    , ADMINISTRATOR_APPROVAL_DATE
    , DATE_OF_RECOMMENDATION
FROM HHS_CMS_HR.INCENTIVES_PDP
;
/
-- End of VW_INCENTIVES_PDP

GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_PDP TO HHS_CMS_HR_RW_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_PDP TO HHS_CMS_HR_DEV_ROLE;
/

CREATE OR REPLACE VIEW VW_ERLR_GEN
AS
  SELECT
    EG.ERLR_CASE_NUMBER
    , EC.ERLR_JOB_REQ_NUMBER
    , EC.PROCID    
    , EC.ERLR_CASE_CREATE_DT
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = EG.GEN_PRIMARY_SPECIALIST AND ROWNUM = 1)  AS GEN_PRIMARY_SPECIALIST_NAME	
    , EG.GEN_PRIMARY_SPECIALIST AS GEN_PRIMARY_SPECIALIST_ID
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = EG.GEN_SECONDARY_SPECIALIST AND ROWNUM = 1)  AS GEN_SECONDARY_SPECIALIST_NAME
	, EG.GEN_CUSTOMER_NAME
	, EG.GEN_CUSTOMER_PHONE
	, EG.GEN_CUSTOMER_ADMIN_CD
	, EG.GEN_CUSTOMER_ADMIN_CD_DESC
	, EG.GEN_EMPLOYEE_NAME
	, EG.GEN_EMPLOYEE_PHONE
	, EG.GEN_EMPLOYEE_ADMIN_CD
	, EG.GEN_EMPLOYEE_ADMIN_CD_DESC
	, FN_GET_2ND_SUB_ORG(EG.GEN_EMPLOYEE_ADMIN_CD) AS GEN_EMPLOYEE_2ND_SUB_ORG
	, EG.GEN_CASE_DESC
	, EG.GEN_CASE_STATUS
	, EG.GEN_CUST_INIT_CONTACT_DT
	, EG.GEN_PRIMARY_REP_AFFILIATION
	, EG.GEN_CMS_PRIMARY_REP_ID AS GEN_CMS_PRIMARY_REP_NAME
	, EG.GEN_CMS_PRIMARY_REP_PHONE
	, EG.GEN_NON_CMS_PRIMARY_FNAME
	, EG.GEN_NON_CMS_PRIMARY_MNAME
	, EG.GEN_NON_CMS_PRIMARY_LNAME
	, EG.GEN_NON_CMS_PRIMARY_EMAIL
	, EG.GEN_NON_CMS_PRIMARY_PHONE
	, EG.GEN_NON_CMS_PRIMARY_ORG
	, EG.GEN_NON_CMS_PRIMARY_ADDR
	, (SELECT L.TBL_LABEL FROM TBL_LOOKUP L WHERE L.TBL_ID = EG.GEN_CASE_TYPE AND ROWNUM = 1) AS GEN_CASE_TYPE
	, FN_GET_CASE_CATEGORY(EG.GEN_CASE_CATEGORY) AS GEN_CASE_CATEGORY
	, EG.GEN_INVESTIGATION
	, EG.GEN_INVESTIGATE_START_DT
	, EG.GEN_INVESTIGATE_END_DT
	, EG.GEN_STD_CONDUCT
	, EG.GEN_STD_CONDUCT_TYPE
	, EG.CC_FINAL_ACTION
    , EG.CC_FINAL_ACTION_OTHER
	, EG.CC_CASE_COMPLETE_DT
	, (SELECT STATE FROM BIZFLOW.PROCS P WHERE P.PROCID = EC.PROCID) AS BF_PROCS_STATE
	, (SELECT MOD_DT FROM TBL_FORM_DTL FD WHERE FD.PROCID = EC.PROCID) AS LAST_MOD_DTS
	, ETPH.THRD_PRTY_APPEAL_TYPE
    , EG.CANCEL_REASON
FROM
	ERLR_GEN EG
    LEFT OUTER JOIN ERLR_CASE EC ON EG.ERLR_CASE_NUMBER = EC.ERLR_CASE_NUMBER
	LEFT OUTER JOIN ERLR_3RDPARTY_HEAR ETPH ON EG.ERLR_CASE_NUMBER = ETPH.ERLR_CASE_NUMBER;
 
/

CREATE OR REPLACE VIEW VW_RPT_ERLR_TRENDS
AS
SELECT
      P.COMPONENT,
      G.ERLR_CASE_NUMBER CASENUMBER,
      G.GEN_EMPLOYEE_NAME EMPNAME,
      G.GEN_CUSTOMER_NAME CONTACTNAME,
      G.GEN_EMPLOYEE_2ND_SUB_ORG SECONDSUBORGDESC,
      G.GEN_EMPLOYEE_ADMIN_CD ADMINCD,
      G.GEN_CASE_TYPE CASETYPE,
      G.GEN_CASE_CATEGORY CASECATEGORY,
      CASE 
        WHEN TRIM( G.CC_FINAL_ACTION_OTHER ) IS NOT NULL THEN G.CC_FINAL_ACTION || ' - ' || G.CC_FINAL_ACTION_OTHER
        ELSE G.CC_FINAL_ACTION
      END FINAL_ACTION,
      G.GEN_CUST_INIT_CONTACT_DT INITIALCONTACTDATE,
      G.CC_CASE_COMPLETE_DT DATE_CASE_COMPLETED,
      G.GEN_CLASS AS TYPE      
  FROM (SELECT COMPONENT FROM HHS_CMS_HR.CMS_TIME_TO_HIRE_WEEKLY_PILOT GROUP BY COMPONENT) P LEFT OUTER JOIN HHS_CMS_HR.ERLR_GEN G 
       ON NVL(G.GEN_CASE_STATUS,'') <> 'Closed' AND P.COMPONENT = G.GEN_EMPLOYEE_2ND_SUB_ORG;       
/	   
       
GRANT SELECT ON HHS_CMS_HR.VW_RPT_ERLR_TRENDS TO HHS_CMS_HR_RW_ROLE;       
GRANT SELECT ON HHS_CMS_HR.VW_RPT_ERLR_TRENDS TO HHS_CMS_HR_DEV_ROLE;
/

CREATE OR REPLACE VIEW VW_STRATCON
AS
SELECT
	R.REQ_ID
	, R.REQ_JOB_REQ_NUMBER
	, R.REQ_JOB_REQ_CREATE_DT
	, R.REQ_STATUS_ID
	, R.REQ_CANCEL_DT
	, R.REQ_CANCEL_REASON

	, SG.SG_PROCID
	, SG.SG_AC_ID
	--, LU_AC.AC_ADMIN_CD AS SG_AC_CD
	--, LU_AC.AC_ADMIN_CD_DESCR AS SG_AC_DSCR
	, SG.SG_ADMIN_CD AS SG_ADMIN_CD
	--, LU_AC.AC_ADMIN_CD_DESCR AS SG_ADMIN_CD_DSCR
	--, LU_SO_1.AC_ADMIN_CD AS SUB_ORG_1_CD
	--, LU_SO_1.AC_ADMIN_CD_DESCR AS SUB_ORG_1_DSCR
	--, LU_SO_2.AC_ADMIN_CD AS SUB_ORG_2_CD
	--, LU_SO_2.AC_ADMIN_CD_DESCR AS SUB_ORG_2_DSCR
	--, LU_SO_3.AC_ADMIN_CD AS SUB_ORG_3_CD
	--, LU_SO_3.AC_ADMIN_CD_DESCR AS SUB_ORG_3_DSCR
	--, LU_SO_4.AC_ADMIN_CD AS SUB_ORG_4_CD
	--, LU_SO_4.AC_ADMIN_CD_DESCR AS SUB_ORG_4_DSCR
	--, LU_SO_5.AC_ADMIN_CD AS SUB_ORG_5_CD
	--, LU_SO_5.AC_ADMIN_CD_DESCR AS SUB_ORG_5_DSCR
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = SG.SG_ADMIN_CD AND ROWNUM = 1) AS SG_ADMIN_CD_DSCR
	, FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 1) AS SUB_ORG_1_CD
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 1) AND ROWNUM = 1) AS SUB_ORG_1_DSCR
	, FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 2) AS SUB_ORG_2_CD
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 2) AND ROWNUM = 1) AS SUB_ORG_2_DSCR
	, FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 3) AS SUB_ORG_3_CD
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 3) AND ROWNUM = 1) AS SUB_ORG_3_DSCR
	, FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 4) AS SUB_ORG_4_CD
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 4) AND ROWNUM = 1) AS SUB_ORG_4_DSCR
	, FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 5) AS SUB_ORG_5_CD
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 5) AND ROWNUM = 1) AS SUB_ORG_5_DSCR
	, SG.SG_RT_ID
	--, LU_RT.TBL_LABEL AS SG_RT_DSCR
	, (SELECT LU_RT.TBL_LABEL FROM TBL_LOOKUP LU_RT WHERE LU_RT.TBL_ID = SG.SG_RT_ID AND ROWNUM = 1) AS SG_RT_DSCR
	, SG.SG_CT_ID
	--, LU_CT.TBL_LABEL AS SG_CT_DSCR
	, (SELECT LU_CT.TBL_LABEL FROM TBL_LOOKUP LU_CT WHERE LU_CT.TBL_ID = SG.SG_CT_ID AND ROWNUM = 1) AS SG_CT_DSCR
	, SG.SG_AT_ID
	--, LU_AT.TBL_LABEL AS SG_AT_DSCR
	, (SELECT LU_AT.TBL_LABEL FROM TBL_LOOKUP LU_AT WHERE LU_AT.TBL_ID = SG.SG_AT_ID AND ROWNUM = 1) AS SG_AT_DSCR
	, SG.SG_VT_ID
	--, LU_VT.TBL_LABEL AS SG_VT_DSCR
	, (SELECT LU_VT.TBL_LABEL FROM TBL_LOOKUP LU_VT WHERE LU_VT.TBL_ID = SG.SG_VT_ID AND ROWNUM = 1) AS SG_VT_DSCR
	, SG.SG_SAT_ID
	--, LU_SAT.TBL_LABEL AS SG_SAT_DSCR
	, (SELECT LU_SAT.TBL_LABEL FROM TBL_LOOKUP LU_SAT WHERE LU_SAT.TBL_ID = SG.SG_SAT_ID AND ROWNUM = 1) AS SG_SAT_DSCR
	, SG.SG_SO_ID
	--, LU_MEMSO.NAME AS SG_SO_NAME
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = SG.SG_SO_ID AND ROWNUM = 1)  AS SG_SO_NAME
	, SG.SG_SO_TITLE
	, SG.SG_SO_ORG
	, SG.SG_XO_ID
	--, LU_MEMXO.NAME AS SG_XO_NAME
	, FN_GET_NAMES(SG.SG_XO_ID)	AS SG_XO_NAME
	, SG.SG_XO_TITLE
	, SG.SG_XO_ORG
	, SG.SG_HRL_ID
	--, LU_MEMHL.NAME AS SG_HL_NAME
	, FN_GET_NAMES(SG.SG_HRL_ID) AS SG_HL_NAME
	, SG.SG_HRL_TITLE
	, SG.SG_HRL_ORG
	, SG.SG_SS_ID
	--, LU_MEMSS.NAME AS SG_SS_NAME
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = SG.SG_SS_ID AND ROWNUM = 1)  AS SG_SS_NAME
	, SG.SG_CS_ID
	--, LU_MEMCS.NAME AS SG_CS_NAME
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = SG.SG_CS_ID AND ROWNUM = 1)  AS SG_CS_NAME
	, CASE WHEN SG.SG_SO_AGREE = '1' THEN 'Yes' ELSE 'No' END AS SG_SO_AGREE
	, SG.SG_OTHER_CERT
	, FN_GET_MEMBER_DSCR(SG.SG_OTHER_CERT) AS SG_OTHER_CERT_DSCR

	, POS.POS_CNDT_LAST_NM
	, POS.POS_CNDT_FIRST_NM
	, POS.POS_CNDT_MIDDLE_NM
	, CASE WHEN POS.POS_BGT_APR_OFM = '1' THEN 'Yes' WHEN POS.POS_BGT_APR_OFM = '0' THEN 'No' ELSE 'N/A' END AS POS_BGT_APR_OFM
	, POS.POS_SPNSR_ORG_NM
	, POS.POS_SPNSR_ORG_FUND_PC
	, POS.POS_TITLE
	, POS.POS_PAY_PLAN_ID
	--, LU_PYPL.TBL_NAME AS POS_PAY_PLAN_DSCR
	, (SELECT LU_PYPL.TBL_NAME FROM TBL_LOOKUP LU_PYPL WHERE LU_PYPL.TBL_ID = POS.POS_PAY_PLAN_ID AND ROWNUM = 1) AS POS_PAY_PLAN_DSCR
	, POS.POS_SERIES
    , POS.POS_STD_PD_TYPE
	, POS.POS_DESC_NUMBER_1
	, POS.POS_CLASSIFICATION_DT_1
	, POS.POS_GRADE_1
	, POS.POS_DESC_NUMBER_2
	, POS.POS_CLASSIFICATION_DT_2
	, POS.POS_GRADE_2
	, POS.POS_DESC_NUMBER_3
	, POS.POS_CLASSIFICATION_DT_3
	, POS.POS_GRADE_3
	, POS.POS_DESC_NUMBER_4
	, POS.POS_CLASSIFICATION_DT_4
	, POS.POS_GRADE_4
	, POS.POS_DESC_NUMBER_5
	, POS.POS_CLASSIFICATION_DT_5
	, POS.POS_GRADE_5
	, POS.POS_MED_OFFICERS_ID
	--, LU_MO.TBL_LABEL AS POS_MED_OFFICERS_DSCR
	, (SELECT LU_MO.TBL_LABEL FROM TBL_LOOKUP LU_MO WHERE LU_MO.TBL_ID = POS.POS_MED_OFFICERS_ID AND ROWNUM = 1) AS POS_MED_OFFICERS_DSCR
	, POS.POS_PERFORMANCE_LEVEL
	, POS.POS_SUPERVISORY
	--, LU_SUP.TBL_LABEL AS POS_SUPERVISORY_DSCR
	, (SELECT LU_SUP.TBL_LABEL FROM TBL_LOOKUP LU_SUP WHERE LU_SUP.TBL_ID = TO_NUMBER(POS.POS_SUPERVISORY) AND ROWNUM = 1) AS POS_SUPERVISORY_DSCR
	, POS.POS_SKILL
	, POS.POS_LOCATION
	--, LU_LOC.LOC_CITY || ', ' || LU_LOC.LOC_STATE AS POS_LOCATION_DSCR
	, FN_GET_LOCATION_DSCR(POS.POS_LOCATION) AS POS_LOCATION_DSCR
	, POS.POS_VACANCIES
	, POS.POS_REPORT_SUPERVISOR
	--, LU_MEMRS.NAME AS POS_REPORT_SUPERVISOR_NAME
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = POS.POS_REPORT_SUPERVISOR AND ROWNUM = 1)  AS POS_REPORT_SUPERVISOR_NAME
	, POS.POS_CAN
	, CASE WHEN POS.POS_VICE = '1' THEN 'Yes' ELSE 'No' END AS POS_VICE
	, POS.POS_VICE_NAME
	, POS.POS_DAYS_ADVERTISED
	, POS.POS_AT_ID
	--, LU_ADT.TBL_LABEL AS POS_AT_DSCR
	, (SELECT LU_ADT.TBL_LABEL FROM TBL_LOOKUP LU_ADT WHERE LU_ADT.TBL_ID = POS.POS_AT_ID AND ROWNUM = 1) AS POS_AT_DSCR
	, POS.POS_NTE
	, POS.POS_WORK_SCHED_ID
	--, LU_WSCHD.TBL_LABEL AS POS_WORK_SCHED_DSCR
	, (SELECT LU_WSCHD.TBL_LABEL FROM TBL_LOOKUP LU_WSCHD WHERE LU_WSCHD.TBL_ID = POS.POS_WORK_SCHED_ID AND ROWNUM = 1) AS POS_WORK_SCHED_DSCR
	, POS.POS_HOURS_PER_WEEK
	, CASE WHEN POS.POS_DUAL_EMPLMT = '1' THEN 'Yes' WHEN POS.POS_DUAL_EMPLMT = '0' THEN 'No' ELSE NULL END AS POS_DUAL_EMPLMT
	, POS.POS_SEC_ID
	--, LU_SEC.TBL_LABEL AS POS_SEC_DSCR
	, (SELECT LU_SEC.TBL_LABEL FROM TBL_LOOKUP LU_SEC WHERE LU_SEC.TBL_ID = POS.POS_SEC_ID AND ROWNUM = 1) AS POS_SEC_DSCR
	, CASE WHEN POS.POS_CE_FINANCIAL_DISC = '1' THEN 'Yes' ELSE 'No' END AS POS_CE_FINANCIAL_DISC
	, POS.POS_CE_FINANCIAL_TYPE_ID
	--, LU_FNTP.TBL_LABEL AS POS_CE_FINANCIAL_TYPE_DSCR
	, (SELECT LU_FNTP.TBL_LABEL FROM TBL_LOOKUP LU_FNTP WHERE LU_FNTP.TBL_ID = POS.POS_CE_FINANCIAL_TYPE_ID AND ROWNUM = 1) AS POS_CE_FINANCIAL_TYPE_DSCR
	, CASE WHEN POS.POS_CE_PE_PHYSICAL = '1' THEN 'Yes' ELSE 'No' END AS POS_CE_PE_PHYSICAL
	, CASE WHEN POS.POS_CE_DRUG_TEST = '1' THEN 'Yes' ELSE 'No' END AS POS_CE_DRUG_TEST
	, CASE WHEN POS.POS_CE_IMMUN = '1' THEN 'Yes' ELSE 'No' END AS POS_CE_IMMUN
	, CASE WHEN POS.POS_CE_TRAVEL = '1' THEN 'Yes' ELSE 'No' END AS POS_CE_TRAVEL
	, POS.POS_CE_TRAVEL_PER
	, CASE WHEN POS.POS_CE_LIC = '1' THEN 'Yes' ELSE 'No' END AS POS_CE_LIC
	, POS.POS_CE_LIC_INFO
	, POS.POS_REMARKS
	, POS.POS_PROC_REQ_TYPE
	, POS.POS_RECRUIT_OFFICE_ID
	--, POS.POS_REQ_CREATE_NOTIFY_DT
	, POS.POS_SO_ID
	, POS.POS_ASSOC_DESCR_NUMBERS
	, POS.POS_PROMOTE_POTENTIAL
	, POS.POS_VICE_EMPL_ID
	, POS.POS_SR_ID
	, POS.POS_GR_ID
	, POS.POS_AC_ID
	, CASE WHEN POS.POS_GA_1  = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_1
	, CASE WHEN POS.POS_GA_2  = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_2
	, CASE WHEN POS.POS_GA_3  = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_3
	, CASE WHEN POS.POS_GA_4  = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_4
	, CASE WHEN POS.POS_GA_5  = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_5
	, CASE WHEN POS.POS_GA_6  = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_6
	, CASE WHEN POS.POS_GA_7  = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_7
	, CASE WHEN POS.POS_GA_8  = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_8
	, CASE WHEN POS.POS_GA_9  = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_9
	, CASE WHEN POS.POS_GA_10 = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_10
	, CASE WHEN POS.POS_GA_11 = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_11
	, CASE WHEN POS.POS_GA_12 = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_12
	, CASE WHEN POS.POS_GA_13 = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_13
	, CASE WHEN POS.POS_GA_14 = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_14
	, CASE WHEN POS.POS_GA_15 = '1' THEN 'Yes' ELSE 'No' END AS POS_GA_15

	, FN_GET_GRADE_ADVRT(POS.POS_GA_1, POS.POS_GA_2, POS.POS_GA_3, POS.POS_GA_4, POS.POS_GA_5
		 , POS.POS_GA_6, POS.POS_GA_7, POS.POS_GA_8, POS.POS_GA_9, POS.POS_GA_10
		 , POS.POS_GA_11, POS.POS_GA_12, POS.POS_GA_13, POS.POS_GA_14, POS.POS_GA_15)
	AS POS_GA

	, CASE WHEN AOC.AOC_30PCT_DISABLED_VETS = '1' THEN 'Yes' ELSE 'No' END AS AOC_30PCT_DISABLED_VETS
	, CASE WHEN AOC.AOC_EXPERT_CONS = '1'         THEN 'Yes' ELSE 'No' END AS AOC_EXPERT_CONS
	, CASE WHEN AOC.AOC_IPA = '1'                 THEN 'Yes' ELSE 'No' END AS AOC_IPA
	, CASE WHEN AOC.AOC_OPER_WARFIGHTER = '1'     THEN 'Yes' ELSE 'No' END AS AOC_OPER_WARFIGHTER
	, CASE WHEN AOC.AOC_DISABILITIES = '1'        THEN 'Yes' ELSE 'No' END AS AOC_DISABILITIES
	, CASE WHEN AOC.AOC_STUDENT_VOL = '1'         THEN 'Yes' ELSE 'No' END AS AOC_STUDENT_VOL
	, CASE WHEN AOC.AOC_VETS_RECRUIT_APPT = '1'   THEN 'Yes' ELSE 'No' END AS AOC_VETS_RECRUIT_APPT
	, CASE WHEN AOC.AOC_VOC_REHAB_EMPL = '1'      THEN 'Yes' ELSE 'No' END AS AOC_VOC_REHAB_EMPL
	, CASE WHEN AOC.AOC_WORKFORCE_RECRUIT = '1'   THEN 'Yes' ELSE 'No' END AS AOC_WORKFORCE_RECRUIT
	, AOC.AOC_NON_COMP_APPL
	, CASE WHEN AOC.AOC_MIL_SPOUSES = '1'         THEN 'Yes' ELSE 'No' END AS AOC_MIL_SPOUSES
	, CASE WHEN AOC.AOC_DIRECT_HIRE = '1'         THEN 'Yes' ELSE 'No' END AS AOC_DIRECT_HIRE
	, CASE WHEN AOC.AOC_RE_EMPLOYMENT = '1'       THEN 'Yes' ELSE 'No' END AS AOC_RE_EMPLOYMENT
	, CASE WHEN AOC.AOC_PATHWAYS = '1'            THEN 'Yes' ELSE 'No' END AS AOC_PATHWAYS
	, CASE WHEN AOC.AOC_PEACE_CORPS_VOL = '1'     THEN 'Yes' ELSE 'No' END AS AOC_PEACE_CORPS_VOL
	, CASE WHEN AOC.AOC_REINSTATEMENT = '1'       THEN 'Yes' ELSE 'No' END AS AOC_REINSTATEMENT
	, CASE WHEN AOC.AOC_SHARED_CERT = '1'         THEN 'Yes' ELSE 'No' END AS AOC_SHARED_CERT
	, CASE WHEN AOC.AOC_DELEGATE_EXAM = '1'       THEN 'Yes' ELSE 'No' END AS AOC_DELEGATE_EXAM
	, CASE WHEN AOC.AOC_DH_US_CITIZENS = '1'      THEN 'Yes' ELSE 'No' END AS AOC_DH_US_CITIZENS
	, CASE WHEN AOC.AOC_MP_GOV_WIDE = '1'         THEN 'Yes' ELSE 'No' END AS AOC_MP_GOV_WIDE
	, CASE WHEN AOC.AOC_MP_HHS_ONLY = '1'         THEN 'Yes' ELSE 'No' END AS AOC_MP_HHS_ONLY
	, CASE WHEN AOC.AOC_MP_CMS_ONLY = '1'         THEN 'Yes' ELSE 'No' END AS AOC_MP_CMS_ONLY
	, CASE WHEN AOC.AOC_MP_COMP_CONS_ONLY = '1'   THEN 'Yes' ELSE 'No' END AS AOC_MP_COMP_CONS_ONLY
	, CASE WHEN AOC.AOC_MP_I_CTAP_VEGA = '1'      THEN 'Yes' ELSE 'No' END AS AOC_MP_I_CTAP_VEGA
	, AOC.AOC_NON_BARGAIN_DOC_RATIONALE

	, FN_GET_ANNOUNCE_NOT_REQ(AOC.AOC_30PCT_DISABLED_VETS
		, AOC.AOC_EXPERT_CONS
		, AOC.AOC_IPA
		, AOC.AOC_OPER_WARFIGHTER
		, AOC.AOC_DISABILITIES
		, AOC.AOC_STUDENT_VOL
		, AOC.AOC_VETS_RECRUIT_APPT
		, AOC.AOC_VOC_REHAB_EMPL
		, AOC.AOC_WORKFORCE_RECRUIT)
	AS AOC_ANNOUNCE_NOT_REQ
	, FN_GET_ANNOUNCE_REQ(AOC.AOC_MIL_SPOUSES
		, AOC.AOC_DIRECT_HIRE
		, AOC.AOC_RE_EMPLOYMENT
		, AOC.AOC_PATHWAYS
		, AOC.AOC_PEACE_CORPS_VOL
		, AOC.AOC_REINSTATEMENT
		, AOC.AOC_SHARED_CERT)
	AS AOC_ANNOUNCE_REQ
	, FN_GET_ANNOUNCE_TYPE(AOC.AOC_DELEGATE_EXAM
		, AOC.AOC_DH_US_CITIZENS
		, AOC.AOC_MP_GOV_WIDE
		, AOC.AOC_MP_HHS_ONLY
		, AOC.AOC_MP_CMS_ONLY
		, AOC.AOC_MP_COMP_CONS_ONLY
		, AOC.AOC_MP_I_CTAP_VEGA)
	AS AOC_ANNOUNCE_TYPE

	, CASE WHEN SME.SME_FOR_JOB_ANALYSIS = '1'  THEN 'Yes' ELSE 'No' END AS SME_FOR_JOB_ANALYSIS
	, SME.SME_NAME_JA
	, SME.SME_EMAIL_JA
	, CASE WHEN SME.SME_FOR_QUALIFICATION = '1' THEN 'Yes' ELSE 'No' END AS SME_FOR_QUALIFICATION
	, SME.SME_NAME_QUAL_1
	, SME.SME_EMAIL_QUAL_1
	, SME.SME_NAME_QUAL_2
	, SME.SME_EMAIL_QUAL_2

	, CASE WHEN JA.JA_SEL_FACTOR_REQ = '1'   THEN 'Yes' ELSE 'No' END AS JA_SEL_FACTOR_REQ
	, JA.JA_SEL_FACTOR_JUST
	, CASE WHEN JA.JA_QUAL_RANK_REQ = '1'    THEN 'Yes' ELSE 'No' END AS JA_QUAL_RANK_REQ
	, JA.JA_QUAL_RANK_JUST
	, CASE WHEN JA.JA_RESPONSES_REQ = '1'    THEN 'Yes' ELSE 'No' END AS JA_RESPONSES_REQ
	, CASE WHEN JA.JA_TYPE_YES_NO = '1'      THEN 'Yes' ELSE 'No' END AS JA_TYPE_YES_NO
	, CASE WHEN JA.JA_TYPE_REQ_DEFAULT = '1' THEN 'Yes' ELSE 'No' END AS JA_TYPE_REQ_DEFAULT
	, CASE WHEN JA.JA_TYPE_KNOWL_SCALE = '1' THEN 'Yes' ELSE 'No' END AS JA_TYPE_KNOWL_SCALE

	, FN_GET_ASSESS_TYPE(JA.JA_TYPE_YES_NO
		, JA.JA_TYPE_REQ_DEFAULT
		, JA.JA_TYPE_KNOWL_SCALE)
	AS JA_ASSESS_TYPE

	, RI.RI_OA_APRV_ITEM
	, CASE
		WHEN RI.RI_OA_APRV_ITEM = 'C' THEN 'Recruitment'
		WHEN RI.RI_OA_APRV_ITEM = 'L' THEN 'Relocation'
		ELSE 'N/A'
	END AS RI_OA_APRV_ITEM_DSCR
	, CASE WHEN RI.RI_MOVING_EXP_AUTH = '1' THEN 'Yes' ELSE 'No' END AS RI_MOVING_EXP_AUTH

	, CASE WHEN TR.TR_PAID_AD = '1' THEN 'Yes' ELSE 'No' END AS TR_PAID_AD
	, TR.TR_PAID_AD_SPEC
	, FN_GET_LOOKUP_DSCR(TR.TR_PAID_AD_SPEC) AS TR_PAID_AD_SPEC_DSCR
	, TR.TR_PAID_AD_SPEC_OTHR
	, CASE WHEN TR.TR_SCHL_PSTG = '1' THEN 'Yes' ELSE 'No' END AS TR_SCHL_PSTG
	, TR.TR_SCHL_PSTG_SPEC
	, FN_GET_LOOKUP_DSCR(TR.TR_SCHL_PSTG_SPEC) AS TR_SCHL_PSTG_SPEC_DSCR
	, TR.TR_SCHL_PSTG_SPEC_OTHR
	, CASE WHEN TR.TR_SOCIAL_MEDIA = '1' THEN 'Yes' ELSE 'No' END AS TR_SOCIAL_MEDIA
	, TR.TR_SOCIAL_MEDIA_SPEC
	, FN_GET_LOOKUP_DSCR(TR.TR_SOCIAL_MEDIA_SPEC) AS TR_SOCIAL_MEDIA_SPEC_DSCR
	, TR.TR_SOCIAL_MEDIA_SPEC_OTHR
	, CASE WHEN TR.TR_OTHER = '1' THEN 'Yes' ELSE 'No' END AS TR_OTHER
	, TR.TR_OTHER_SPEC

	, SCA.SCA_SO_SIG
	, SCA.SCA_SO_SIG_DT
	, SCA.SCA_CLASS_SPEC_SIG
	, SCA.SCA_CLASS_SPEC_SIG_DT
	, SCA.SCA_STAFF_SIG
	, SCA.SCA_STAFF_SIG_DT

FROM
	REQUEST R
	LEFT OUTER JOIN STRATCON_GEN SG ON SG.SG_REQ_ID = R.REQ_ID
	LEFT OUTER JOIN POSITION POS ON POS.POS_REQ_ID = R.REQ_ID
	--LEFT OUTER JOIN STRATCON_SCHED_HIST SSH ON SSH.SSH_REQ_ID = R.REQ_ID
	LEFT OUTER JOIN AREAS_OF_CONS AOC ON AOC.AOC_REQ_ID = R.REQ_ID
	LEFT OUTER JOIN SME_INFO SME ON SME.SME_REQ_ID = R.REQ_ID
	LEFT OUTER JOIN JOB_ANALYSIS JA ON JA.JA_REQ_ID = R.REQ_ID
	LEFT OUTER JOIN RECRUIT_INCENTIVES RI ON RI.RI_REQ_ID = R.REQ_ID
	LEFT OUTER JOIN TARGET_RECRUIT TR ON TR.TR_REQ_ID = R.REQ_ID
	LEFT OUTER JOIN APPROVALS SCA ON SCA.SCA_REQ_ID = R.REQ_ID

	--LEFT OUTER JOIN ADMIN_CODES LU_AC ON LU_AC.AC_ID = SG.SG_AC_ID
	--LEFT OUTER JOIN ADMIN_CODES LU_AC ON LU_AC.AC_ADMIN_CD = SG.SG_ADMIN_CD
	--LEFT OUTER JOIN ADMIN_CODES LU_SO_1 ON LU_SO_1.AC_ADMIN_CD = FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 1)
	--LEFT OUTER JOIN ADMIN_CODES LU_SO_2 ON LU_SO_2.AC_ADMIN_CD = FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 2)
	--LEFT OUTER JOIN ADMIN_CODES LU_SO_3 ON LU_SO_3.AC_ADMIN_CD = FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 3)
	--LEFT OUTER JOIN ADMIN_CODES LU_SO_4 ON LU_SO_4.AC_ADMIN_CD = FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 4)
	--LEFT OUTER JOIN ADMIN_CODES LU_SO_5 ON LU_SO_5.AC_ADMIN_CD = FN_GET_SUBORG_CD(SG.SG_ADMIN_CD, 5)
    
	--LEFT OUTER JOIN TBL_LOOKUP LU_RT ON LU_RT.TBL_ID = SG.SG_RT_ID
	--LEFT OUTER JOIN TBL_LOOKUP LU_CT ON LU_CT.TBL_ID = SG.SG_CT_ID
	--LEFT OUTER JOIN TBL_LOOKUP LU_AT ON LU_AT.TBL_ID = SG.SG_AT_ID
	--LEFT OUTER JOIN TBL_LOOKUP LU_VT ON LU_VT.TBL_ID = SG.SG_VT_ID
	--LEFT OUTER JOIN TBL_LOOKUP LU_SAT ON LU_SAT.TBL_ID = SG.SG_SAT_ID
    
	--LEFT OUTER JOIN BIZFLOW.MEMBER LU_MEMSO ON LU_MEMSO.MEMBERID = SG.SG_SO_ID
	--LEFT OUTER JOIN BIZFLOW.MEMBER LU_MEMXO ON LU_MEMXO.MEMBERID = SG.SG_XO_ID
	--LEFT OUTER JOIN BIZFLOW.MEMBER LU_MEMHL ON LU_MEMHL.MEMBERID = SG.SG_HRL_ID
	--LEFT OUTER JOIN BIZFLOW.MEMBER LU_MEMSS ON LU_MEMSS.MEMBERID = SG.SG_SS_ID
	--LEFT OUTER JOIN BIZFLOW.MEMBER LU_MEMCS ON LU_MEMCS.MEMBERID = SG.SG_CS_ID

	--LEFT OUTER JOIN TBL_LOOKUP LU_PYPL ON LU_PYPL.TBL_ID = POS.POS_PAY_PLAN_ID
	--LEFT OUTER JOIN TBL_LOOKUP LU_MO ON LU_MO.TBL_ID = POS.POS_MED_OFFICERS_ID
--TODO: Remove TO_NUMBER call once the data type of POS_SUPERVISORY is fixed to NUMBER(20)
	--LEFT OUTER JOIN TBL_LOOKUP LU_SUP ON LU_SUP.TBL_ID = TO_NUMBER(POS.POS_SUPERVISORY)
	--LEFT OUTER JOIN LOCATION LU_LOC ON LU_LOC.LOC_ID = POS.POS_LOCATION
	--LEFT OUTER JOIN BIZFLOW.MEMBER LU_MEMRS ON LU_MEMRS.MEMBERID = POS.POS_REPORT_SUPERVISOR
	--LEFT OUTER JOIN TBL_LOOKUP LU_ADT ON LU_ADT.TBL_ID = POS.POS_AT_ID
	--LEFT OUTER JOIN TBL_LOOKUP LU_WSCHD ON LU_WSCHD.TBL_ID = POS.POS_WORK_SCHED_ID
	--LEFT OUTER JOIN TBL_LOOKUP LU_SEC ON LU_SEC.TBL_ID = POS.POS_SEC_ID
	--LEFT OUTER JOIN TBL_LOOKUP LU_FNTP ON LU_FNTP.TBL_ID = POS.POS_CE_FINANCIAL_TYPE_ID
;
/
-- End of VW_STRATCON

CREATE OR REPLACE VIEW VW_CLASSIFICATION
AS
SELECT
	R.REQ_ID
	, R.REQ_JOB_REQ_NUMBER
	, R.REQ_JOB_REQ_CREATE_DT
	, R.REQ_STATUS_ID
	, R.REQ_CANCEL_DT
	, R.REQ_CANCEL_REASON

	, CS.CS_TITLE
	, CS.CS_PAY_PLAN_ID
	--, LU_PYPL.TBL_NAME AS CS_PAY_PLAN_DSCR
	, (SELECT LU_PYPL.TBL_NAME FROM TBL_LOOKUP LU_PYPL WHERE LU_PYPL.TBL_ID = CS.CS_PAY_PLAN_ID AND ROWNUM = 1) AS CS_PAY_PLAN_DSCR
	, CS.CS_SR_ID
	--, LU_SR.TBL_LABEL AS CS_SR_DSCR
	, (SELECT LU_SR.TBL_LABEL FROM TBL_LOOKUP LU_SR WHERE LU_SR.TBL_ID = CS.CS_SR_ID AND ROWNUM = 1) AS CS_SR_DSCR
	, CS.CS_PD_NUMBER_JOBCD_1
	, CS.CS_CLASSIFICATION_DT_1
	, CS.CS_GR_ID_1
	, CS.CS_FLSA_DETERM_ID_1
	--, LU_FLSA_1.TBL_LABEL AS CS_FLSA_DETERM_DSCR_1
	, (SELECT LU_FLSA.TBL_LABEL FROM TBL_LOOKUP LU_FLSA WHERE LU_FLSA.TBL_ID = CS.CS_FLSA_DETERM_ID_1 AND ROWNUM = 1) AS CS_FLSA_DETERM_DSCR_1
	, CS.CS_PD_NUMBER_JOBCD_2
	, CS.CS_CLASSIFICATION_DT_2
	, CS.CS_GR_ID_2
	, CS.CS_FLSA_DETERM_ID_2
	--, LU_FLSA_2.TBL_LABEL AS CS_FLSA_DETERM_DSCR_2
	, (SELECT LU_FLSA.TBL_LABEL FROM TBL_LOOKUP LU_FLSA WHERE LU_FLSA.TBL_ID = CS.CS_FLSA_DETERM_ID_2 AND ROWNUM = 1) AS CS_FLSA_DETERM_DSCR_2
	, CS.CS_PD_NUMBER_JOBCD_3
	, CS.CS_CLASSIFICATION_DT_3
	, CS.CS_GR_ID_3
	, CS.CS_FLSA_DETERM_ID_3
	--, LU_FLSA_3.TBL_LABEL AS CS_FLSA_DETERM_DSCR_3
	, (SELECT LU_FLSA.TBL_LABEL FROM TBL_LOOKUP LU_FLSA WHERE LU_FLSA.TBL_ID = CS.CS_FLSA_DETERM_ID_3 AND ROWNUM = 1) AS CS_FLSA_DETERM_DSCR_3
	, CS.CS_PD_NUMBER_JOBCD_4
	, CS.CS_CLASSIFICATION_DT_4
	, CS.CS_GR_ID_4
	, CS.CS_FLSA_DETERM_ID_4
	--, LU_FLSA_4.TBL_LABEL AS CS_FLSA_DETERM_DSCR_4
	, (SELECT LU_FLSA.TBL_LABEL FROM TBL_LOOKUP LU_FLSA WHERE LU_FLSA.TBL_ID = CS.CS_FLSA_DETERM_ID_4 AND ROWNUM = 1) AS CS_FLSA_DETERM_DSCR_4
	, CS.CS_PD_NUMBER_JOBCD_5
	, CS.CS_CLASSIFICATION_DT_5
	, CS.CS_GR_ID_5
	, CS.CS_FLSA_DETERM_ID_5
	--, LU_FLSA_5.TBL_LABEL AS CS_FLSA_DETERM_DSCR_5
	, (SELECT LU_FLSA.TBL_LABEL FROM TBL_LOOKUP LU_FLSA WHERE LU_FLSA.TBL_ID = CS.CS_FLSA_DETERM_ID_5 AND ROWNUM = 1) AS CS_FLSA_DETERM_DSCR_5
	, CS.CS_PERFORMANCE_LEVEL
	, CS.CS_SUPERVISORY
	--, LU_SUP.TBL_LABEL AS CS_SUPERVISORY_DSCR
	, (SELECT LU_SUP.TBL_LABEL FROM TBL_LOOKUP LU_SUP WHERE LU_SUP.TBL_ID = CS.CS_SUPERVISORY AND ROWNUM = 1) AS CS_SUPERVISORY_DSCR
	, CS.CS_AC_ID
	--, LU_AC.AC_ADMIN_CD AS CS_AC_CD
	--, LU_AC.AC_ADMIN_CD_DESCR AS CS_AC_DSCR
	, CS.CS_ADMIN_CD AS CS_ADMIN_CD
	--, LU_AC.AC_ADMIN_CD_DESCR AS CS_ADMIN_CD_DSCR
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = CS_ADMIN_CD AND ROWNUM = 1) AS CS_ADMIN_CD_DSCR
	, CS.SO_ID
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = CS.SO_ID AND ROWNUM = 1)  AS SO_NAME
	, CS.SO_TITLE
	, CS.SO_ORG
	, CS.XO_ID
	, FN_GET_NAMES(CS.XO_ID)  AS XO_NAME
	, CS.XO_TITLE
	, CS.XO_ORG
	, CS.HRL_ID
	, FN_GET_NAMES(CS.HRL_ID)  AS HL_NAME
	, CS.HRL_TITLE
	, CS.HRL_ORG
	, CS.SS_ID
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = CS.SS_ID AND ROWNUM = 1)  AS SS_NAME
	, CS.CS_ID
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = CS.CS_ID AND ROWNUM = 1)  AS CS_NAME
	, CS.CS_FIN_STMT_REQ_ID
	--, LU_FNTP.TBL_LABEL AS CS_FIN_STMT_REQ_DSCR
	, (SELECT LU_FNTP.TBL_LABEL FROM TBL_LOOKUP LU_FNTP WHERE LU_FNTP.TBL_ID = CS.CS_FIN_STMT_REQ_ID AND ROWNUM = 1) AS CS_FIN_STMT_REQ_DSCR
	, CS.CS_SEC_ID
	--, LU_SEC.TBL_LABEL AS CS_SEC_DSCR
	, (SELECT LU_SEC.TBL_LABEL FROM TBL_LOOKUP LU_SEC WHERE LU_SEC.TBL_ID = CS.CS_SEC_ID AND ROWNUM = 1) AS CS_SEC_DSCR
	, PD.PD_ID
	, PD.PD_PROCID
	, PD.PD_ORG_POS_TITLE
	, PD.PD_EMPLOYING_OFFICE
	--, LU_EO.TBL_LABEL AS PD_EMPLOYING_OFFICE_DSCR
	, (SELECT LU_EO.TBL_LABEL FROM TBL_LOOKUP LU_EO WHERE LU_EO.TBL_ID = PD.PD_EMPLOYING_OFFICE AND ROWNUM = 1) AS PD_EMPLOYING_OFFICE_DSCR
	, CASE WHEN PD.PD_SUBJECT_IA = '1' THEN 'Yes' ELSE 'No' END AS PD_SUBJECT_IA
	, PD.PD_ORGANIZATION
	, PD.PD_SUB_ORG_1
	--, LU_SO_1.AC_ADMIN_CD_DESCR AS PD_SUB_ORG_DSCR_1
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = PD_SUB_ORG_1 AND ROWNUM = 1) AS PD_SUB_ORG_DSCR_1
	, PD.PD_SUB_ORG_2
	--, LU_SO_2.AC_ADMIN_CD_DESCR AS PD_SUB_ORG_DSCR_2
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = PD_SUB_ORG_2 AND ROWNUM = 1) AS PD_SUB_ORG_DSCR_2
	, PD.PD_SUB_ORG_3
	--, LU_SO_3.AC_ADMIN_CD_DESCR AS PD_SUB_ORG_DSCR_3
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = PD_SUB_ORG_3 AND ROWNUM = 1) AS PD_SUB_ORG_DSCR_3
	, PD.PD_SUB_ORG_4
	--, LU_SO_4.AC_ADMIN_CD_DESCR AS PD_SUB_ORG_DSCR_4
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = PD_SUB_ORG_4 AND ROWNUM = 1) AS PD_SUB_ORG_DSCR_4
	, PD.PD_SUB_ORG_5
	--, LU_SO_5.AC_ADMIN_CD_DESCR AS PD_SUB_ORG_DSCR_5
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = PD_SUB_ORG_5 AND ROWNUM = 1) AS PD_SUB_ORG_DSCR_5
	, PD.PD_SCOPE
    , PD.STD_PD_TYPE
	, CASE WHEN PD.PD_PCA = '1'        THEN 'Yes' ELSE 'No' END AS PD_PCA
	, CASE WHEN PD.PD_PDP = '1'        THEN 'Yes' ELSE 'No' END AS PD_PDP
	, CASE WHEN PD.PD_FTT = '1'        THEN 'Yes' ELSE 'No' END AS PD_FTT
	, CASE WHEN PD.PD_OUTSTATION = '1' THEN 'Yes' ELSE 'No' END AS PD_OUTSTATION
	, CASE WHEN PD.PD_INCUMBENCY = '1' THEN 'Yes' ELSE 'No' END AS PD_INCUMBENCY
	, PD.PD_REMARKS
	, PD.PD_CLS_STANDARDS
	, FN_GET_LOOKUP_DSCR(PD.PD_CLS_STANDARDS) AS PD_CLS_STANDARDS_DSCR
	, PD.PD_ACQ_CODE
	--, LU_ACQ.TBL_NAME AS PD_ACQ_CODE_DSCR
	, (SELECT LU_ACQ.TBL_NAME FROM TBL_LOOKUP LU_ACQ WHERE LU_ACQ.TBL_ID = PD.PD_ACQ_CODE AND ROWNUM = 1) AS PD_ACQ_CODE_DSCR
	, PD.PD_CYB_SEC_CD
	--, LU_CSEC.TBL_LABEL AS PD_CYB_SEC_CD_DSCR
	--, (SELECT LU_CSEC.TBL_LABEL FROM TBL_LOOKUP LU_CSEC WHERE LU_CSEC.TBL_ID = PD.PD_CYB_SEC_CD AND ROWNUM = 1) AS PD_CYB_SEC_CD_DSCR
	, FN_GET_LOOKUP_DSCR(PD.PD_CYB_SEC_CD) AS PD_CYB_SEC_CD_DSCR
	, PD.PD_COMPET_LVL_CD
	, PD.PD_BUS_CD
	--, LU_BUS.TBL_LABEL AS PD_BUS_CD_DSCR
	, (SELECT LU_BUS.TBL_LABEL FROM TBL_LOOKUP LU_BUS WHERE LU_BUS.TBL_ID = PD.PD_BUS_CD AND ROWNUM = 1) AS PD_BUS_CD_DSCR
	, PD.BYPASS_DWC_FL

	, CASE WHEN PD.PD_SUPV_CERT = '1' THEN 'Yes' ELSE 'No' END AS PD_SUPV_CERT
	, PD.PD_SUPV_NAME
	, PD.PD_SUPV_TITLE
	, PD.PD_SUPV_SIG
	, PD.PD_SUPV_SIG_DT
	, CASE WHEN PD.PD_CLS_SPEC_CERT = '1' THEN 'Yes' ELSE 'No' END AS PD_CLS_SPEC_CERT
	, PD.PD_CLS_SPEC_NAME
	, PD.PD_CLS_SPEC_TITLE
	, PD.PD_CLS_SPEC_SIG
	, PD.PD_CLS_SPEC_DT

	, CASE WHEN FLSA.FLSA_EX_EXEC = '1'            THEN 'Yes' ELSE 'No' END AS FLSA_EX_EXEC
	, CASE WHEN FLSA.FLSA_EX_ADMIN = '1'           THEN 'Yes' ELSE 'No' END AS FLSA_EX_ADMIN
	, CASE WHEN FLSA.FLSA_EX_PROF_LEARNED = '1'    THEN 'Yes' ELSE 'No' END AS FLSA_EX_PROF_LEARNED
	, CASE WHEN FLSA.FLSA_EX_PROF_CREATIVE = '1'   THEN 'Yes' ELSE 'No' END AS FLSA_EX_PROF_CREATIVE
	, CASE WHEN FLSA.FLSA_EX_PROF_COMPUTER = '1'   THEN 'Yes' ELSE 'No' END AS FLSA_EX_PROF_COMPUTER
	, CASE WHEN FLSA.FLSA_EX_LAW_ENFORC = '1'      THEN 'Yes' ELSE 'No' END AS FLSA_EX_LAW_ENFORC
	, CASE WHEN FLSA.FLSA_EX_FOREIGN = '1'         THEN 'Yes' ELSE 'No' END AS FLSA_EX_FOREIGN
	, FLSA.FLSA_EX_REMARKS
	, CASE WHEN FLSA.FLSA_NONEX_SALARY = '1'       THEN 'Yes' ELSE 'No' END AS FLSA_NONEX_SALARY
	, CASE WHEN FLSA.FLSA_NONEX_EQUIP_OPER = '1'   THEN 'Yes' ELSE 'No' END AS FLSA_NONEX_EQUIP_OPER
	, CASE WHEN FLSA.FLSA_NONEX_TECHN = '1'        THEN 'Yes' ELSE 'No' END AS FLSA_NONEX_TECHN
	, CASE WHEN FLSA.FLSA_NONEX_FED_WAGE_SYS = '1' THEN 'Yes' ELSE 'No' END AS FLSA_NONEX_FED_WAGE_SYS
	, FLSA.FLSA_NONEX_REMARKS

FROM
	REQUEST R
	LEFT OUTER JOIN CLASSIF_STRATCON CS ON CS.CS_REQ_ID = R.REQ_ID
	LEFT OUTER JOIN PD_COVERSHEET PD ON PD.PD_REQ_ID = R.REQ_ID
	LEFT OUTER JOIN FLSA FLSA ON FLSA.FLSA_PD_ID = PD.PD_ID

	--LEFT OUTER JOIN TBL_LOOKUP LU_PYPL ON LU_PYPL.TBL_ID = CS.CS_PAY_PLAN_ID
	--LEFT OUTER JOIN TBL_LOOKUP LU_SR ON LU_SR.TBL_ID = CS.CS_SR_ID
	--LEFT OUTER JOIN TBL_LOOKUP LU_FLSA_1 ON LU_FLSA_1.TBL_ID = CS.CS_FLSA_DETERM_ID_1
	--LEFT OUTER JOIN TBL_LOOKUP LU_FLSA_2 ON LU_FLSA_2.TBL_ID = CS.CS_FLSA_DETERM_ID_2
	--LEFT OUTER JOIN TBL_LOOKUP LU_FLSA_3 ON LU_FLSA_3.TBL_ID = CS.CS_FLSA_DETERM_ID_3
	--LEFT OUTER JOIN TBL_LOOKUP LU_FLSA_4 ON LU_FLSA_4.TBL_ID = CS.CS_FLSA_DETERM_ID_4
	--LEFT OUTER JOIN TBL_LOOKUP LU_FLSA_5 ON LU_FLSA_5.TBL_ID = CS.CS_FLSA_DETERM_ID_5
	--LEFT OUTER JOIN TBL_LOOKUP LU_SUP ON LU_SUP.TBL_ID = CS.CS_SUPERVISORY
	--LEFT OUTER JOIN ADMIN_CODES LU_AC ON LU_AC.AC_ID = CS.CS_AC_ID
	--LEFT OUTER JOIN ADMIN_CODES LU_AC ON LU_AC.AC_ADMIN_CD = CS.CS_ADMIN_CD
	--LEFT OUTER JOIN TBL_LOOKUP LU_FNTP ON LU_FNTP.TBL_ID = CS.CS_FIN_STMT_REQ_ID
	--LEFT OUTER JOIN TBL_LOOKUP LU_SEC ON LU_SEC.TBL_ID = CS.CS_SEC_ID

	--LEFT OUTER JOIN TBL_LOOKUP LU_EO ON LU_EO.TBL_ID = PD.PD_EMPLOYING_OFFICE
	--LEFT OUTER JOIN ADMIN_CODES LU_SO_1 ON LU_SO_1.AC_ADMIN_CD = PD.PD_SUB_ORG_1
	--LEFT OUTER JOIN ADMIN_CODES LU_SO_2 ON LU_SO_2.AC_ADMIN_CD = PD.PD_SUB_ORG_2
	--LEFT OUTER JOIN ADMIN_CODES LU_SO_3 ON LU_SO_3.AC_ADMIN_CD = PD.PD_SUB_ORG_3
	--LEFT OUTER JOIN ADMIN_CODES LU_SO_4 ON LU_SO_4.AC_ADMIN_CD = PD.PD_SUB_ORG_4
	--LEFT OUTER JOIN ADMIN_CODES LU_SO_5 ON LU_SO_5.AC_ADMIN_CD = PD.PD_SUB_ORG_5
	--LEFT OUTER JOIN TBL_LOOKUP LU_ACQ ON LU_ACQ.TBL_ID = PD.PD_ACQ_CODE
	--LEFT OUTER JOIN TBL_LOOKUP LU_CSEC ON LU_CSEC.TBL_ID = PD.PD_CYB_SEC_CD
	--LEFT OUTER JOIN TBL_LOOKUP LU_BUS ON LU_BUS.TBL_ID = PD.PD_BUS_CD
;
/
-- End of VW_CLASSIFICATION

CREATE OR REPLACE VIEW VW_ELIGQUAL
AS
SELECT
	R.REQ_ID
	, R.REQ_JOB_REQ_NUMBER
	, R.REQ_JOB_REQ_CREATE_DT
	, R.REQ_STATUS_ID
	, R.REQ_CANCEL_DT
	, R.REQ_CANCEL_REASON

	, EQ.ELIGQUAL_ID
	, EQ.PROCID
	, EQ.ADMIN_CD AS ADMIN_CD
	--, LU_AC.AC_ADMIN_CD_DESCR AS ADMIN_CD_DSCR
	--, LU_SO_1.AC_ADMIN_CD AS SUB_ORG_1_CD
	--, LU_SO_1.AC_ADMIN_CD_DESCR AS SUB_ORG_1_DSCR
	--, LU_SO_2.AC_ADMIN_CD AS SUB_ORG_2_CD
	--, LU_SO_2.AC_ADMIN_CD_DESCR AS SUB_ORG_2_DSCR
	--, LU_SO_3.AC_ADMIN_CD AS SUB_ORG_3_CD
	--, LU_SO_3.AC_ADMIN_CD_DESCR AS SUB_ORG_3_DSCR
	--, LU_SO_4.AC_ADMIN_CD AS SUB_ORG_4_CD
	--, LU_SO_4.AC_ADMIN_CD_DESCR AS SUB_ORG_4_DSCR
	--, LU_SO_5.AC_ADMIN_CD AS SUB_ORG_5_CD
	--, LU_SO_5.AC_ADMIN_CD_DESCR AS SUB_ORG_5_DSCR
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = EQ.ADMIN_CD AND ROWNUM = 1) AS ADMIN_CD_DSCR
	, FN_GET_SUBORG_CD(EQ.ADMIN_CD, 1) AS SUB_ORG_1_CD
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = FN_GET_SUBORG_CD(EQ.ADMIN_CD, 1) AND ROWNUM = 1) AS SUB_ORG_1_DSCR
	, FN_GET_SUBORG_CD(EQ.ADMIN_CD, 2) AS SUB_ORG_2_CD
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = FN_GET_SUBORG_CD(EQ.ADMIN_CD, 2) AND ROWNUM = 1) AS SUB_ORG_2_DSCR
	, FN_GET_SUBORG_CD(EQ.ADMIN_CD, 3) AS SUB_ORG_3_CD
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = FN_GET_SUBORG_CD(EQ.ADMIN_CD, 3) AND ROWNUM = 1) AS SUB_ORG_3_DSCR
	, FN_GET_SUBORG_CD(EQ.ADMIN_CD, 4) AS SUB_ORG_4_CD
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = FN_GET_SUBORG_CD(EQ.ADMIN_CD, 4) AND ROWNUM = 1) AS SUB_ORG_4_DSCR
	, FN_GET_SUBORG_CD(EQ.ADMIN_CD, 5) AS SUB_ORG_5_CD
	, (SELECT AC.AC_ADMIN_CD_DESCR FROM ADMIN_CODES AC WHERE AC.AC_ADMIN_CD = FN_GET_SUBORG_CD(EQ.ADMIN_CD, 5) AND ROWNUM = 1) AS SUB_ORG_5_DSCR
	, EQ.RT_ID
	--, LU_RT.TBL_LABEL AS RT_DSCR
	, (SELECT LU_RT.TBL_LABEL FROM TBL_LOOKUP LU_RT WHERE LU_RT.TBL_ID = EQ.RT_ID AND ROWNUM = 1) AS RT_DSCR
	, EQ.AT_ID
	--, LU_AT.TBL_LABEL AS AT_DSCR
	, (SELECT LU_AT.TBL_LABEL FROM TBL_LOOKUP LU_AT WHERE LU_AT.TBL_ID = EQ.AT_ID AND ROWNUM = 1) AS AT_DSCR
	, EQ.VT_ID
	--, LU_VT.TBL_LABEL AS VT_DSCR
	, (SELECT LU_VT.TBL_LABEL FROM TBL_LOOKUP LU_VT WHERE LU_VT.TBL_ID = EQ.VT_ID AND ROWNUM = 1) AS VT_DSCR
	, EQ.SAT_ID
	--, LU_SAT.TBL_LABEL AS SAT_DSCR
	, (SELECT LU_SAT.TBL_LABEL FROM TBL_LOOKUP LU_SAT WHERE LU_SAT.TBL_ID = EQ.SAT_ID AND ROWNUM = 1)  AS SAT_DSCR
	, EQ.CT_ID
	--, LU_CT.TBL_LABEL AS CT_DSCR
	, (SELECT LU_CT.TBL_LABEL FROM TBL_LOOKUP LU_CT WHERE LU_CT.TBL_ID = EQ.CT_ID AND ROWNUM = 1)  AS CT_DSCR
	, EQ.SO_ID
	--, LU_MEMSO.NAME AS SO_NAME
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = EQ.SO_ID AND ROWNUM = 1)  AS SO_NAME
	, EQ.SO_TITLE
	, EQ.SO_ORG
	, EQ.XO_ID
	--, LU_MEMXO.NAME AS XO_NAME
	, FN_GET_NAMES(EQ.XO_ID)  AS XO_NAME
	, EQ.XO_TITLE
	, EQ.XO_ORG
	, EQ.HRL_ID
	--, LU_MEMHL.NAME AS HL_NAME
	, FN_GET_NAMES(EQ.HRL_ID)  AS HL_NAME    
	, EQ.HRL_TITLE
	, EQ.HRL_ORG
	, EQ.SS_ID
	--, LU_MEMSS.NAME AS SS_NAME
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = EQ.SS_ID AND ROWNUM = 1)  AS SS_NAME
	, EQ.CS_ID
	--, LU_MEMCS.NAME AS CS_NAME
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = EQ.CS_ID AND ROWNUM = 1)  AS CS_NAME
	, CASE WHEN EQ.SO_AGREE = '1' THEN 'Yes' ELSE 'No' END AS SO_AGREE
	, EQ.OTHER_CERT
	, FN_GET_MEMBER_DSCR(EQ.OTHER_CERT) AS OTHER_CERT_DSCR

	, EQ.CNDT_LAST_NM
	, EQ.CNDT_FIRST_NM
	, EQ.CNDT_MIDDLE_NM
	, CASE WHEN EQ.BGT_APR_OFM = '1' THEN 'Yes' WHEN EQ.BGT_APR_OFM = '0' THEN 'No' ELSE 'N/A' END AS BGT_APR_OFM
	, EQ.SPNSR_ORG_NM
	, EQ.SPNSR_ORG_FUND_PC
	, EQ.POS_TITLE
	, EQ.PAY_PLAN_ID
	--, LU_PYPL.TBL_NAME AS PAY_PLAN_DSCR
	, (SELECT LU_PYPL.TBL_NAME FROM TBL_LOOKUP LU_PYPL WHERE LU_PYPL.TBL_ID = EQ.PAY_PLAN_ID AND ROWNUM = 1)  AS PAY_PLAN_DSCR
	, EQ.SERIES
	, EQ.POS_DESC_NUMBER_1
	, EQ.CLASSIFICATION_DT_1
	, EQ.GRADE_1
	, EQ.POS_DESC_NUMBER_2
	, EQ.CLASSIFICATION_DT_2
	, EQ.GRADE_2
	, EQ.POS_DESC_NUMBER_3
	, EQ.CLASSIFICATION_DT_3
	, EQ.GRADE_3
	, EQ.POS_DESC_NUMBER_4
	, EQ.CLASSIFICATION_DT_4
	, EQ.GRADE_4
	, EQ.POS_DESC_NUMBER_5
	, EQ.CLASSIFICATION_DT_5
	, EQ.GRADE_5
	, EQ.MED_OFFICERS_ID
	--, LU_MO.TBL_LABEL AS MED_OFFICERS_DSCR
	, (SELECT  LU_MO.TBL_LABEL FROM TBL_LOOKUP LU_MO WHERE LU_MO.TBL_ID = EQ.MED_OFFICERS_ID AND ROWNUM = 1)  AS MED_OFFICERS_DSCR
	, EQ.PERFORMANCE_LEVEL
	, EQ.SUPERVISORY
	--, LU_SUP.TBL_LABEL AS SUPERVISORY_DSCR
	, (SELECT LU_SUP.TBL_LABEL FROM TBL_LOOKUP LU_SUP WHERE LU_SUP.TBL_ID = EQ.SUPERVISORY AND ROWNUM = 1)  AS SUPERVISORY_DSCR
	, EQ.SKILL
	, EQ.LOCATION
	--, LU_LOC.LOC_CITY || ', ' || LU_LOC.LOC_STATE AS LOCATION_DSCR
	, FN_GET_LOCATION_DSCR(EQ.LOCATION) AS LOCATION_DSCR
	, EQ.VACANCIES
	, EQ.REPORT_SUPERVISOR
	--, LU_MEMRS.NAME AS REPORT_SUPERVISOR_NAME
	, (SELECT M.NAME FROM BIZFLOW.MEMBER M WHERE M.MEMBERID = EQ.REPORT_SUPERVISOR AND ROWNUM = 1)  AS REPORT_SUPERVISOR_NAME
	, EQ.CAN
	, CASE WHEN EQ.VICE = '1' THEN 'Yes' ELSE 'No' END AS VICE
	, EQ.VICE_NAME
	, EQ.DAYS_ADVERTISED
	, EQ.TA_ID
	--, LU_ADT.TBL_LABEL AS TA_DSCR
	, (SELECT LU_ADT.TBL_LABEL FROM TBL_LOOKUP LU_ADT WHERE LU_ADT.TBL_ID = EQ.TA_ID AND ROWNUM = 1)  AS TA_DSCR
	, EQ.NTE
	, EQ.WORK_SCHED_ID
	--, LU_WSCHD.TBL_LABEL AS WORK_SCHED_DSCR
	, (SELECT LU_WSCHD.TBL_LABEL FROM TBL_LOOKUP LU_WSCHD WHERE LU_WSCHD.TBL_ID = EQ.WORK_SCHED_ID AND ROWNUM = 1)  AS WORK_SCHED_DSCR
	, EQ.HOURS_PER_WEEK
	, CASE WHEN EQ.DUAL_EMPLMT = '1' THEN 'Yes' WHEN EQ.DUAL_EMPLMT = '0' THEN 'No' ELSE NULL END AS DUAL_EMPLMT
	, EQ.SEC_ID
	--, LU_SEC.TBL_LABEL AS SEC_DSCR
	, (SELECT LU_SEC.TBL_LABEL FROM TBL_LOOKUP LU_SEC WHERE LU_SEC.TBL_ID = EQ.SEC_ID AND ROWNUM = 1)  AS SEC_DSCR
	, CASE WHEN EQ.CE_FINANCIAL_DISC = '1' THEN 'Yes' ELSE 'No' END AS CE_FINANCIAL_DISC
	, EQ.CE_FINANCIAL_TYPE_ID
	--, LU_FNTP.TBL_LABEL AS CE_FINANCIAL_TYPE_DSCR
	, (SELECT LU_FNTP.TBL_LABEL FROM TBL_LOOKUP LU_FNTP WHERE LU_FNTP.TBL_ID = EQ.CE_FINANCIAL_TYPE_ID AND ROWNUM = 1)  AS CE_FINANCIAL_TYPE_DSCR
	, CASE WHEN EQ.CE_PE_PHYSICAL = '1' THEN 'Yes' ELSE 'No' END AS CE_PE_PHYSICAL
	, CASE WHEN EQ.CE_DRUG_TEST = '1' THEN 'Yes' ELSE 'No' END AS CE_DRUG_TEST
	, CASE WHEN EQ.CE_IMMUN = '1' THEN 'Yes' ELSE 'No' END AS CE_IMMUN
	, CASE WHEN EQ.CE_TRAVEL = '1' THEN 'Yes' ELSE 'No' END AS CE_TRAVEL
	, EQ.CE_TRAVEL_PER
	, CASE WHEN EQ.CE_LIC = '1' THEN 'Yes' ELSE 'No' END AS CE_LIC
	, EQ.CE_LIC_INFO
	, EQ.REMARKS
	, EQ.PROC_REQ_TYPE
	, EQ.RECRUIT_OFFICE_ID
	, EQ.ASSOC_DESCR_NUMBERS
	, EQ.PROMOTE_POTENTIAL
	, EQ.VICE_EMPL_ID
	, EQ.SR_ID
	, EQ.GR_ID
	, CASE WHEN EQ.GA_1  = '1' THEN 'Yes' ELSE 'No' END AS GA_1
	, CASE WHEN EQ.GA_2  = '1' THEN 'Yes' ELSE 'No' END AS GA_2
	, CASE WHEN EQ.GA_3  = '1' THEN 'Yes' ELSE 'No' END AS GA_3
	, CASE WHEN EQ.GA_4  = '1' THEN 'Yes' ELSE 'No' END AS GA_4
	, CASE WHEN EQ.GA_5  = '1' THEN 'Yes' ELSE 'No' END AS GA_5
	, CASE WHEN EQ.GA_6  = '1' THEN 'Yes' ELSE 'No' END AS GA_6
	, CASE WHEN EQ.GA_7  = '1' THEN 'Yes' ELSE 'No' END AS GA_7
	, CASE WHEN EQ.GA_8  = '1' THEN 'Yes' ELSE 'No' END AS GA_8
	, CASE WHEN EQ.GA_9  = '1' THEN 'Yes' ELSE 'No' END AS GA_9
	, CASE WHEN EQ.GA_10 = '1' THEN 'Yes' ELSE 'No' END AS GA_10
	, CASE WHEN EQ.GA_11 = '1' THEN 'Yes' ELSE 'No' END AS GA_11
	, CASE WHEN EQ.GA_12 = '1' THEN 'Yes' ELSE 'No' END AS GA_12
	, CASE WHEN EQ.GA_13 = '1' THEN 'Yes' ELSE 'No' END AS GA_13
	, CASE WHEN EQ.GA_14 = '1' THEN 'Yes' ELSE 'No' END AS GA_14
	, CASE WHEN EQ.GA_15 = '1' THEN 'Yes' ELSE 'No' END AS GA_15

	, FN_GET_GRADE_ADVRT(EQ.GA_1, EQ.GA_2, EQ.GA_3, EQ.GA_4, EQ.GA_5
		 , EQ.GA_6, EQ.GA_7, EQ.GA_8, EQ.GA_9, EQ.GA_10
		 , EQ.GA_11, EQ.GA_12, EQ.GA_13, EQ.GA_14, EQ.GA_15)
	AS GA

	, EQ.CNDT_ELIGIBLE
	, EQ.INELIG_REASON
	--, LU_IER.TBL_LABEL AS INELIG_REASON_DSCR
	, (SELECT LU_IER.TBL_LABEL FROM TBL_LOOKUP LU_IER WHERE LU_IER.TBL_ID = EQ.INELIG_REASON AND ROWNUM = 1)  AS INELIG_REASON_DSCR
	, EQ.CNDT_QUALIFIED
	, EQ.DISQUAL_REASON
	--, LU_DQR.TBL_LABEL AS DISQUAL_REASON_DSCR
	, (SELECT LU_DQR.TBL_LABEL FROM TBL_LOOKUP LU_DQR WHERE LU_DQR.TBL_ID = EQ.DISQUAL_REASON AND ROWNUM = 1)  AS DISQUAL_REASON_DSCR
	, EQ.SEL_DETERM
	--, LU_SD.TBL_LABEL AS SEL_DETERM_DSCR
	, (SELECT LU_SD.TBL_LABEL FROM TBL_LOOKUP LU_SD WHERE LU_SD.TBL_ID = EQ.SEL_DETERM AND ROWNUM = 1)  AS SEL_DETERM_DSCR
	, EQ.DCO_CERT
	, EQ.DCO_NAME
	, EQ.DCO_SIG
	, EQ.DCO_SIG_DT

FROM
	REQUEST R
	LEFT OUTER JOIN ELIG_QUAL EQ ON EQ.REQ_ID = R.REQ_ID
;
/

/*
 * Performance Tuning
 * Change the view to pull records not from XML but custom tables
 * Adding new column with correct datatype, and populate the column value from the varchar2 column
 */

CREATE OR REPLACE FORCE VIEW HHS_CMS_HR.VW_INCENTIVES_SAM
(
    PROC_ID
    ,INIT_SALARY_GRADE
    ,INIT_SALARY_STEP
    ,INIT_SALARY_SALARY_PER_ANNUM
    ,INIT_SALARY_LOCALITY_PAY_SCALE
    ,SUPPORT_SAM
    ,RCMD_SALARY_GRADE
    ,RCMD_SALARY_STEP
    ,RCMD_SALARY_SALARY_PER_ANNUM
    ,RCMD_SALARY_LOCALITY_PAY_SCALE
    ,SELECTEE_SALARY_PER_ANNUM
    ,SELECTEE_SALARY_TYPE
    ,SELECTEE_BONUS
    ,SELECTEE_BENEFITS
    ,SELECTEE_TOTAL_COMPENSATION
    ,SUP_DOC_REQ_DATE
    ,SUP_DOC_RCV_DATE
    ,JUSTIFICATION_SUPER_QUAL_DESC
    ,JUSTIFICATION_QUAL_COMP_DESC
    ,JUSTIFICATION_PAY_EQUITY_DESC
    ,JUSTIFICATION_EXIST_PKG_DESC
    ,JUSTIFICATION_EXPLAIN_CONSID
    ,SELECT_MEET_ELIGIBILITY
    ,SELECT_MEET_CRITERIA
    ,SUPERIOR_QUAL_REASON
    ,OTHER_FACTORS
    ,SPL_AGENCY_NEED_RSN
    ,SPL_AGENCY_NEED_RSN_ESS
    ,QUAL_REAPPT
    ,OTHER_EXCEPTS
    ,BASIC_PAY_RATE_FACTOR1
    ,BASIC_PAY_RATE_FACTOR2
    ,BASIC_PAY_RATE_FACTOR3
    ,BASIC_PAY_RATE_FACTOR4
    ,BASIC_PAY_RATE_FACTOR5
    ,BASIC_PAY_RATE_FACTOR6
    ,BASIC_PAY_RATE_FACTOR7
    ,BASIC_PAY_RATE_FACTOR8
    ,BASIC_PAY_RATE_FACTOR9
    ,BASIC_PAY_RATE_FACTOR10
    ,OTHER_RLVNT_FACTOR
    ,OTHER_REQ_JUST_APVD
    ,OTHER_REQ_SUFF_INFO_PRVD
    ,OTHER_REQ_INCEN_REQD
    ,OTHER_REQ_DOC_PRVD
    ,HRS_RVW_CERT
    ,HRS_NOT_SPT_RSN
    ,RVW_HRS
    ,HRS_RVW_DATE
    ,RCMD_GRADE
    ,RCMD_STEP
    ,RCMD_SALARY_PER_ANNUM
    ,RCMD_LOCALITY_PAY_SCALE
    ,RCMD_INC_DEC_AMOUNT
    ,RCMD_PERC_DIFF
    ,OHC_APPRO_REQ
    ,RCMD_APPRO_OHC_NAME
    ,RCMD_APPRO_OHC_EMAIL
    ,RCMD_APPRO_OHC_ID
    ,RVW_REMARKS
    ,APPROVAL_SO_VALUE
    ,APPROVAL_SO
    ,APPROVAL_SO_RESP_DATE 
    ,APPROVAL_DGHO_VALUE
    ,APPROVAL_DGHO
    ,APPROVAL_DGHO_RESP_DATE 
    ,APPROVAL_TABG_VALUE
    ,APPROVAL_TABG
    ,APPROVAL_TABG_RESP_DATE 
    ,APPROVAL_OHC_VALUE
    ,APPROVAL_OHC
    ,APPROVAL_OHC_RESP_DATE 
    ,APPROVER_NOTES
    ,COC_NAME
    ,COC_EMAIL
    ,COC_ID
    ,COC_TITLE
    ,APPROVAL_COC_VALUE
    ,APPROVAL_COC_ACTING
    ,APPROVAL_COC
    ,APPROVAL_COC_RESP_DATE 
    ,APPROVAL_SO_ACTING
    ,APPROVAL_DGHO_ACTING
    ,APPROVAL_TABG_ACTING
    ,APPROVAL_OHC_ACTING
    ,JUSTIFICATION_MOD_REASON
    ,JUSTIFICATION_MOD_SUMMARY
    ,JUSTIFICATION_MODIFIER_NAME
    ,JUSTIFICATION_MODIFIER_ID
    ,JUSTIFICATION_MODIFIED_DATE
    ,JUSTIFICATION_VER
    ,JUSTIFICATION_CRT_NAME
    ,JUSTIFICATION_CRT_ID
    ,JUSTIFICATION_CRT_DATE 
    ,JUSTIFICATION_LASTMOD_NAME
    ,JUSTIFICATION_LASTMOD_ID
    ,JUSTIFICATION_LASTMOD_DATE
    ,INIT_SALARY_SALARY_PER_ANNUM_N
    ,RCMD_SALARY_SALARY_PER_ANNUM_N
    ,SELECTEE_SALARY_PER_ANNUM_N
    ,SELECTEE_BONUS_N
    ,SELECTEE_TOTAL_COMPENSATION_N
    ,SUP_DOC_REQ_DATE_D
    ,SUP_DOC_RCV_DATE_D
    ,HRS_RVW_DATE_D
    ,RCMD_SALARY_PER_ANNUM_N
    ,RCMD_INC_DEC_AMOUNT_N
    ,APPROVAL_SO_RESP_DATE_D
    ,APPROVAL_DGHO_RESP_DATE_D
    ,APPROVAL_TABG_RESP_DATE_D
    ,APPROVAL_OHC_RESP_DATE_D
    ,APPROVAL_COC_RESP_DATE_D
    ,JUSTIFICATION_MODIFIED_DATE_D
    ,JUSTIFICATION_CRT_DATE_D
    ,JUSTIFICATION_LASTMOD_DATE_D
)
AS
--------------------------------------------------------------------------------------------------------------------------------
SELECT 
    PROC_ID
    ,INIT_SALARY_GRADE
    ,INIT_SALARY_STEP
    ,TO_CHAR(INIT_SALARY_SALARY_PER_ANNUM_N, '$999,999,999,999,999,999.99' ) as INIT_SALARY_SALARY_PER_ANNUM 
    ,INIT_SALARY_LOCALITY_PAY_SCALE
    ,SUPPORT_SAM
    ,RCMD_SALARY_GRADE
    ,RCMD_SALARY_STEP
    ,TO_CHAR(RCMD_SALARY_SALARY_PER_ANNUM_N, '$999,999,999,999,999,999.99' ) as RCMD_SALARY_SALARY_PER_ANNUM
    ,RCMD_SALARY_LOCALITY_PAY_SCALE
    ,TO_CHAR(SELECTEE_SALARY_PER_ANNUM_N, '$999,999,999,999,999,999.99' ) as SELECTEE_SALARY_PER_ANNUM
    ,SELECTEE_SALARY_TYPE
    ,TO_CHAR(SELECTEE_BONUS_N, '$999,999,999,999,999,999.99' ) as SELECTEE_BONUS
    ,SELECTEE_BENEFITS
    ,TO_CHAR(SELECTEE_TOTAL_COMPENSATION_N, '$999,999,999,999,999,999.99' ) as SELECTEE_TOTAL_COMPENSATION
    ,TO_CHAR(SUP_DOC_REQ_DATE_D, 'mm/dd/yyyy') as SUP_DOC_REQ_DATE
    ,TO_CHAR(SUP_DOC_RCV_DATE_D, 'mm/dd/yyyy') as SUP_DOC_RCV_DATE
    ,JUSTIFICATION_SUPER_QUAL_DESC
    ,JUSTIFICATION_QUAL_COMP_DESC
    ,JUSTIFICATION_PAY_EQUITY_DESC
    ,JUSTIFICATION_EXIST_PKG_DESC
    ,JUSTIFICATION_EXPLAIN_CONSID
    ,SELECT_MEET_ELIGIBILITY
    ,SELECT_MEET_CRITERIA
    ,SUPERIOR_QUAL_REASON
    ,OTHER_FACTORS
    ,SPL_AGENCY_NEED_RSN
    ,SPL_AGENCY_NEED_RSN_ESS
    ,QUAL_REAPPT
    ,OTHER_EXCEPTS
    ,BASIC_PAY_RATE_FACTOR1
    ,BASIC_PAY_RATE_FACTOR2
    ,BASIC_PAY_RATE_FACTOR3
    ,BASIC_PAY_RATE_FACTOR4
    ,BASIC_PAY_RATE_FACTOR5
    ,BASIC_PAY_RATE_FACTOR6
    ,BASIC_PAY_RATE_FACTOR7
    ,BASIC_PAY_RATE_FACTOR8
    ,BASIC_PAY_RATE_FACTOR9
    ,BASIC_PAY_RATE_FACTOR10
    ,OTHER_RLVNT_FACTOR
    ,OTHER_REQ_JUST_APVD
    ,OTHER_REQ_SUFF_INFO_PRVD
    ,OTHER_REQ_INCEN_REQD
    ,OTHER_REQ_DOC_PRVD
    ,HRS_RVW_CERT
    ,HRS_NOT_SPT_RSN
    ,RVW_HRS
    ,TO_CHAR(HRS_RVW_DATE_D, 'mm/dd/yyyy') as HRS_RVW_DATE
    ,RCMD_GRADE
    ,RCMD_STEP
    ,DECODE(RCMD_SALARY_PER_ANNUM_N, 0, '0.00', TO_CHAR(RCMD_SALARY_PER_ANNUM_N, 's999,999,999,999,999,999.99')) as RCMD_SALARY_PER_ANNUM
    ,RCMD_LOCALITY_PAY_SCALE
    ,DECODE(RCMD_INC_DEC_AMOUNT_N, 0, '0.00', TO_CHAR(RCMD_INC_DEC_AMOUNT_N, 's999,999,999,999,999,999.99')) as RCMD_INC_DEC_AMOUNT 
    ,RCMD_PERC_DIFF
    ,OHC_APPRO_REQ
    ,RCMD_APPRO_OHC_NAME
    ,RCMD_APPRO_OHC_EMAIL
    ,RCMD_APPRO_OHC_ID
    ,RVW_REMARKS
    ,APPROVAL_SO_VALUE
    ,APPROVAL_SO
    ,TO_CHAR(APPROVAL_SO_RESP_DATE_D, 'mm/dd/yyyy') as APPROVAL_SO_RESP_DATE
    ,APPROVAL_DGHO_VALUE
    ,APPROVAL_DGHO
    ,TO_CHAR(APPROVAL_DGHO_RESP_DATE_D, 'mm/dd/yyyy') as APPROVAL_DGHO_RESP_DATE
    ,APPROVAL_TABG_VALUE
    ,APPROVAL_TABG
    ,TO_CHAR(APPROVAL_TABG_RESP_DATE_D, 'mm/dd/yyyy') as APPROVAL_TABG_RESP_DATE
    ,APPROVAL_OHC_VALUE
    ,APPROVAL_OHC
    ,TO_CHAR(APPROVAL_OHC_RESP_DATE_D, 'mm/dd/yyyy') as APPROVAL_OHC_RESP_DATE
    ,APPROVER_NOTES
    ,COC_NAME
    ,COC_EMAIL
    ,COC_ID
    ,COC_TITLE
    ,APPROVAL_COC_VALUE
    ,APPROVAL_COC_ACTING
    ,APPROVAL_COC
    ,TO_CHAR(APPROVAL_COC_RESP_DATE_D, 'mm/dd/yyyy') as APPROVAL_COC_RESP_DATE
    ,APPROVAL_SO_ACTING
    ,APPROVAL_DGHO_ACTING
    ,APPROVAL_TABG_ACTING
    ,APPROVAL_OHC_ACTING
    ,JUSTIFICATION_MOD_REASON
    ,JUSTIFICATION_MOD_SUMMARY
    ,JUSTIFICATION_MODIFIER_NAME
    ,JUSTIFICATION_MODIFIER_ID
    ,TO_CHAR(JUSTIFICATION_MODIFIED_DATE_D, 'mm/dd/yyyy hh24:mi:ss') as JUSTIFICATION_MODIFIED_DATE
    ,JUSTIFICATION_VER
    ,JUSTIFICATION_CRT_NAME
    ,JUSTIFICATION_CRT_ID
    ,TO_CHAR(JUSTIFICATION_CRT_DATE_D, 'mm/dd/yyyy hh24:mi:ss') as JUSTIFICATION_CRT_DATE
    ,JUSTIFICATION_LASTMOD_NAME
    ,JUSTIFICATION_LASTMOD_ID
    ,TO_CHAR(JUSTIFICATION_LASTMOD_DATE_D, 'mm/dd/yyyy hh24:mi:ss') as JUSTIFICATION_LASTMOD_DATE
    ,INIT_SALARY_SALARY_PER_ANNUM_N
    ,RCMD_SALARY_SALARY_PER_ANNUM_N
    ,SELECTEE_SALARY_PER_ANNUM_N
    ,SELECTEE_BONUS_N
    ,SELECTEE_TOTAL_COMPENSATION_N
    ,SUP_DOC_REQ_DATE_D 
    ,SUP_DOC_RCV_DATE_D
    ,HRS_RVW_DATE_D
    ,RCMD_SALARY_PER_ANNUM_N
    ,RCMD_INC_DEC_AMOUNT_N
    ,APPROVAL_SO_RESP_DATE_D
    ,APPROVAL_DGHO_RESP_DATE_D
    ,APPROVAL_TABG_RESP_DATE_D
    ,APPROVAL_OHC_RESP_DATE_D
    ,APPROVAL_COC_RESP_DATE_D
    ,JUSTIFICATION_MODIFIED_DATE_D
    ,JUSTIFICATION_CRT_DATE_D
    ,JUSTIFICATION_LASTMOD_DATE_D
FROM HHS_CMS_HR.INCENTIVES_SAM
;

/

--------------------------------------------------------
--  DDL for View VW_INCENTIVES_LE
--------------------------------------------------------
  CREATE OR REPLACE FORCE VIEW HHS_CMS_HR.VW_INCENTIVES_LE(
                PROC_ID
                ,INIT_ANN_LA_RATE
                ,SUPPORT_LE
                ,PROPS_ANN_LA_RATE
                ,JUSTIFICATION_SKILL_EXP
                ,JUSTIFICATION_AGENCY_GOAL
                ,SELECTEE_ELIGIBILITY
                ,HRS_RVW_CERT
                ,HRS_NOT_SPT_RSN
                ,RVW_HRS
                ,HRS_RVW_DATE
                ,RCMD_LA_RATE
                ,APPROVAL_SO_VALUE
                ,APPROVAL_SO
                ,APPROVAL_SO_RESP_DATE
                ,APPROVAL_DGHO_VALUE
                ,APPROVAL_DGHO
                ,APPROVAL_DGHO_RESP_DATE
                ,APPROVAL_TABG_VALUE
                ,APPROVAL_TABG
                ,APPROVAL_TABG_RESP_DATE
                ,COC_NAME
                ,COC_EMAIL
                ,COC_ID
                ,COC_TITLE
                ,APPROVAL_COC_VALUE
                ,APPROVAL_COC_ACTING
                ,APPROVAL_COC
                ,APPROVAL_COC_RESP_DATE
                ,APPROVAL_SO_ACTING
                ,APPROVAL_DGHO_ACTING
                ,APPROVAL_TABG_ACTING
                ,JUSTIFICATION_VER
                ,JUSTIFICATION_CRT_NAME
                ,JUSTIFICATION_CRT_ID
                ,JUSTIFICATION_CRT_DATE
                ,JUSTIFICATION_LASTMOD_NAME
                ,JUSTIFICATION_LASTMOD_ID
                ,JUSTIFICATION_LASTMOD_DATE
                ,JUSTIFICATION_MOD_REASON
                ,JUSTIFICATION_MOD_SUMMARY
                ,JUSTIFICATION_MODIFIER_NAME
                ,JUSTIFICATION_MODIFIER_ID
                ,JUSTIFICATION_MODIFIED_DATE
                ,TOTAL_CREDITABLE_YEARS
                ,TOTAL_CREDITABLE_MONTHS
                ,APPROVER_NOTES
                ,HRS_RVW_DATE_D
                ,APPROVAL_SO_RESP_DATE_D
                ,APPROVAL_DGHO_RESP_DATE_D
)
AS
--------------------------------------------------------------------------------------------------------------------------------
SELECT 

                PROC_ID
                ,INIT_ANN_LA_RATE
                ,SUPPORT_LE
                ,PROPS_ANN_LA_RATE
                ,JUSTIFICATION_SKILL_EXP
                ,JUSTIFICATION_AGENCY_GOAL
                ,SELECTEE_ELIGIBILITY
                ,HRS_RVW_CERT
                ,HRS_NOT_SPT_RSN
                ,RVW_HRS
                ,TO_CHAR(HRS_RVW_DATE_D, 'mm/dd/yyyy') as HRS_RVW_DATE
                ,RCMD_LA_RATE
                ,APPROVAL_SO_VALUE
                ,APPROVAL_SO
                ,TO_CHAR(APPROVAL_SO_RESP_DATE_D, 'mm/dd/yyyy') as APPROVAL_SO_RESP_DATE
                ,APPROVAL_DGHO_VALUE
                ,APPROVAL_DGHO
                ,TO_CHAR(APPROVAL_DGHO_RESP_DATE_D, 'mm/dd/yyyy') as APPROVAL_DGHO_RESP_DATE
                ,APPROVAL_TABG_VALUE
                ,APPROVAL_TABG
                ,TO_CHAR(APPROVAL_TABG_RESP_DATE_D, 'mm/dd/yyyy') as APPROVAL_TABG_RESP_DATE
                ,COC_NAME
                ,COC_EMAIL
                ,COC_ID
                ,COC_TITLE
                ,APPROVAL_COC_VALUE
                ,APPROVAL_COC_ACTING
                ,APPROVAL_COC
                ,TO_CHAR(APPROVAL_COC_RESP_DATE_D, 'mm/dd/yyyy') as APPROVAL_COC_RESP_DATE
                ,APPROVAL_SO_ACTING
                ,APPROVAL_DGHO_ACTING
                ,APPROVAL_TABG_ACTING
                ,JUSTIFICATION_VER
                ,JUSTIFICATION_CRT_NAME
                ,JUSTIFICATION_CRT_ID
                ,TO_CHAR(JUSTIFICATION_CRT_DATE_D, 'mm/dd/yyyy hh24:mi:ss') as JUSTIFICATION_CRT_DATE
                ,JUSTIFICATION_LASTMOD_NAME
                ,JUSTIFICATION_LASTMOD_ID
                ,TO_CHAR(JUSTIFICATION_LASTMOD_DATE_D, 'mm/dd/yyyy hh24:mi:ss') as JUSTIFICATION_LASTMOD_DATE
                ,JUSTIFICATION_MOD_REASON
                ,JUSTIFICATION_MOD_SUMMARY
                ,JUSTIFICATION_MODIFIER_NAME
                ,JUSTIFICATION_MODIFIER_ID
                ,TO_CHAR(JUSTIFICATION_MODIFIED_DATE_D, 'mm/dd/yyyy hh24:mi:ss') as JUSTIFICATION_MODIFIED_DATE
                ,TOTAL_CREDITABLE_YEARS
                ,TOTAL_CREDITABLE_MONTHS
                ,APPROVER_NOTES
                ,HRS_RVW_DATE_D
                ,APPROVAL_SO_RESP_DATE_D
                ,APPROVAL_DGHO_RESP_DATE_D
FROM HHS_CMS_HR.INCENTIVES_LE                
;
/

--------------------------------------------------------
--  DDL for View VW_INCENTIVES_LE_CRED
--------------------------------------------------------

CREATE OR REPLACE FORCE VIEW HHS_CMS_HR.VW_INCENTIVES_LE_CRED (
        PROC_ID
        ,SEQ_NUM
        ,START_DATE
        ,END_DATE
        ,WORK_SCHEDULE
        ,POS_TITLE
        ,CALCULATED_YEARS
        ,CALCULATED_MONTHS
        ,CREDITABLE_YEARS
        ,CREDITABLE_MONTHS 
  ) AS 
SELECT PROC_ID
        ,SEQ_NUM
        ,START_DATE
        ,END_DATE
        ,WORK_SCHEDULE
        ,POS_TITLE
        ,CALCULATED_YEARS
        ,CALCULATED_MONTHS
        ,CREDITABLE_YEARS
        ,CREDITABLE_MONTHS 
FROM HHS_CMS_HR.INCENTIVES_LE_CRED
;
/

CREATE OR REPLACE FORCE VIEW HHS_CMS_HR.VW_INCENTIVES_PCA (
    PROC_ID
    ,PCA_TYPE
    ,CANDI_AGREE
    ,CP_NAME
    ,CP_EMAIL
    ,CP_ID
    ,OFM_NAME
    ,OFM_EMAIL
    ,OFM_ID
    ,ADMIN_APPROVAL_REQ
    ,OHC_NAME
    ,OHC_EMAIL
    ,OHC_ID
    ,OADMIN_NAME
    ,OADMIN_EMAIL
    ,OADMIN_ID
    ,WORK_SCHEDULE
    ,HOURS_PER_WEEK
    ,BD_CERT_REQ
    ,LIC_INFO
    ,LIC_STATE1_STATE
    ,LIC_STATE1_NAME
    ,LIC_STATE1_EXP_DATE --
    ,LIC_STATE2_STATE
    ,LIC_STATE2_NAME
    ,LIC_STATE2_EXP_DATE --
    ,BD_CERT_SPEC1
    ,BD_CERT_SPEC2
    ,BD_CERT_SPEC3
    ,BD_CERT_SPEC4
    ,BD_CERT_SPEC5
    ,BD_CERT_SPEC6
    ,BD_CERT_SPEC7
    ,BD_CERT_SPEC8
    ,BD_CERT_SPEC9
    ,BD_CERT_SPEC_OTHER
    ,LEN_SERVED
    ,LEN_SERVICE
    ,ALW_CATEGORY  --
    ,ALW_BD_CERT --
    ,ALW_MULTI_YEAR_AGMT --
    ,ALW_MISSION_SC --
    ,ALW_TOTAL --
    ,ALW_TOTAL_PAYABLE --
    ,DETAIL_REMARKS
    ,RVW_SO_NAME
    ,RVW_SO_ID
    ,RVW_SO_DATE --
    ,RVW_DGHO_NAME
    ,RVW_DGHO_ID
    ,RVW_DGHO_DATE --
    ,RVW_CP_NAME
    ,RVW_CP_ID
    ,RVW_CP_DATE --
    ,RVW_OFM_NAME
    ,RVW_OFM_ID
    ,RVW_OFM_DATE --
    ,RVW_TABG_NAME
    ,RVW_TABG_ID
    ,RVW_TABG_DATE --
    ,RVW_OHC_NAME
    ,RVW_OHC_ID
    ,RVW_OHC_DATE --
    ,APPROVAL_TABG_NAME
    ,APPROVAL_TABG_ID
    ,APPROVAL_TABG_DATE --
    ,APPROVAL_OADMIN_NAME
    ,APPROVAL_OADMIN_ID
    ,APPROVAL_OADMIN_DATE --
    ---- correct data type
    ,LIC_STATE1_EXP_DATE_D
    ,LIC_STATE2_EXP_DATE_D
    ,ALW_CATEGORY_N
    ,ALW_BD_CERT_N
    ,ALW_MULTI_YEAR_AGMT_N
    ,ALW_MISSION_SC_N
    ,ALW_TOTAL_N
    ,ALW_TOTAL_PAYABLE_N
    ,RVW_SO_DATE_D
    ,RVW_DGHO_DATE_D
    ,RVW_CP_DATE_D
    ,RVW_OFM_DATE_D
    ,RVW_TABG_DATE_D
    ,RVW_OHC_DATE_D
    ,APPROVAL_TABG_DATE_D
    ,APPROVAL_OADMIN_DATE_D
) AS 
SELECT 
    PROC_ID
    ,PCA_TYPE
    ,CANDI_AGREE
    ,CP_NAME
    ,CP_EMAIL
    ,CP_ID
    ,OFM_NAME
    ,OFM_EMAIL
    ,OFM_ID
    ,ADMIN_APPROVAL_REQ
    ,OHC_NAME
    ,OHC_EMAIL
    ,OHC_ID
    ,OADMIN_NAME
    ,OADMIN_EMAIL
    ,OADMIN_ID
    ,WORK_SCHEDULE
    ,HOURS_PER_WEEK
    ,BD_CERT_REQ
    ,LIC_INFO
    ,LIC_STATE1_STATE
    ,LIC_STATE1_NAME
    ,TO_CHAR(LIC_STATE1_EXP_DATE_D, 'mm/dd/yyyy') as LIC_STATE1_EXP_DATE --
    ,LIC_STATE2_STATE
    ,LIC_STATE2_NAME
    ,TO_CHAR(LIC_STATE2_EXP_DATE_D, 'mm/dd/yyyy') as LIC_STATE2_EXP_DATE --
    ,BD_CERT_SPEC1
    ,BD_CERT_SPEC2
    ,BD_CERT_SPEC3
    ,BD_CERT_SPEC4
    ,BD_CERT_SPEC5
    ,BD_CERT_SPEC6
    ,BD_CERT_SPEC7
    ,BD_CERT_SPEC8
    ,BD_CERT_SPEC9
    ,BD_CERT_SPEC_OTHER
    ,LEN_SERVED
    ,LEN_SERVICE
    ,TO_CHAR(ALW_CATEGORY_N, '$999,999,999,999,999,999.99' ) as ALW_CATEGORY  --
    ,TO_CHAR(ALW_BD_CERT_N, '$999,999,999,999,999,999.99' ) as ALW_BD_CERT --
    ,TO_CHAR(ALW_MULTI_YEAR_AGMT_N, '$999,999,999,999,999,999.99' ) as ALW_MULTI_YEAR_AGMT --
    ,TO_CHAR(ALW_MISSION_SC_N, '$999,999,999,999,999,999.99' ) as ALW_MISSION_SC --
    ,TO_CHAR(ALW_TOTAL_N, '$999,999,999,999,999,999.99' ) as ALW_TOTAL --
    ,TO_CHAR(ALW_TOTAL_PAYABLE_N, '$999,999,999,999,999,999.99' ) as ALW_TOTAL_PAYABLE --
    ,DETAIL_REMARKS
    ,RVW_SO_NAME
    ,RVW_SO_ID
    ,TO_CHAR(RVW_SO_DATE_D, 'mm/dd/yyyy') as RVW_SO_DATE --
    ,RVW_DGHO_NAME
    ,RVW_DGHO_ID
    ,TO_CHAR(RVW_DGHO_DATE_D, 'mm/dd/yyyy') as RVW_DGHO_DATE --
    ,RVW_CP_NAME
    ,RVW_CP_ID
    ,TO_CHAR(RVW_CP_DATE_D, 'mm/dd/yyyy') as RVW_CP_DATE --
    ,RVW_OFM_NAME
    ,RVW_OFM_ID
    ,TO_CHAR(RVW_OFM_DATE_D, 'mm/dd/yyyy') as RVW_OFM_DATE --
    ,RVW_TABG_NAME
    ,RVW_TABG_ID
    ,TO_CHAR(RVW_TABG_DATE_D, 'mm/dd/yyyy') as RVW_TABG_DATE --
    ,RVW_OHC_NAME
    ,RVW_OHC_ID
    ,TO_CHAR(RVW_OHC_DATE_D, 'mm/dd/yyyy') as RVW_OHC_DATE --
    ,APPROVAL_TABG_NAME
    ,APPROVAL_TABG_ID
    ,TO_CHAR(APPROVAL_TABG_DATE_D, 'mm/dd/yyyy') as APPROVAL_TABG_DATE --
    ,APPROVAL_OADMIN_NAME
    ,APPROVAL_OADMIN_ID
    ,TO_CHAR(APPROVAL_OADMIN_DATE_D, 'mm/dd/yyyy') as APPROVAL_OADMIN_DATE --
    ---- correct data type
    ,LIC_STATE1_EXP_DATE_D
    ,LIC_STATE2_EXP_DATE_D
    ,ALW_CATEGORY_N
    ,ALW_BD_CERT_N
    ,ALW_MULTI_YEAR_AGMT_N
    ,ALW_MISSION_SC_N
    ,ALW_TOTAL_N
    ,ALW_TOTAL_PAYABLE_N
    ,RVW_SO_DATE_D
    ,RVW_DGHO_DATE_D
    ,RVW_CP_DATE_D
    ,RVW_OFM_DATE_D
    ,RVW_TABG_DATE_D
    ,RVW_OHC_DATE_D
    ,APPROVAL_TABG_DATE_D
    ,APPROVAL_OADMIN_DATE_D
FROM HHS_CMS_HR.INCENTIVES_PCA;
/

CREATE OR REPLACE VIEW VW_ERLR_PROB_ACTION
AS
SELECT
    PA.ERLR_CASE_NUMBER
    , EC.ERLR_JOB_REQ_NUMBER
    , EC.PROCID    
    , EC.ERLR_CASE_CREATE_DT
    , PPA_ACTION_TYPE
	, CASE WHEN PPA_TERMINATION_TYPE = 'pre_emp' THEN 'Pre-Employment'
    WHEN PPA_TERMINATION_TYPE = 'probation' THEN 'Probationary'
    ELSE null END AS PPA_TERMINATION_TYPE
	, PPA_TERM_PROP_ACTION_DT
	, PPA_TERM_ORAL_PREZ_REQUESTED
	, PPA_TERM_ORAL_PREZ_DT
	, PPA_TERM_WRITTEN_RESP
	, PPA_TERM_WRITTEN_RESP_DUE_DT
	, PPA_TERM_WRITTEN_RESP_DT
	, PPA_TERM_AGENCY_DECISION	
    , PPA_TERM_DECIDING_OFFCL_NAME
	, PPA_TERM_DECISION_ISSUED_DT
	, PPA_TERM_EFFECTIVE_DECISION_DT
	, PPA_PROB_TERM_DCSN_ISSUED_DT
	, CASE WHEN PPA_PROBATION_CONDUCT = 'true' THEN 'Yes' ELSE 'No' END AS PPA_PROBATION_CONDUCT
	, CASE WHEN PPA_PROBATION_PERFORMANCE = 'true' THEN 'Yes' ELSE 'No' END AS PPA_PROBATION_PERFORMANCE
	, PPA_APPEAL_GRIEVANCE_DEADLINE
	, PPA_EMP_APPEAL_DECISION
	, PPA_PROP_ACTION_ISSUED_DT
	, PPA_ORAL_PREZ_REQUESTED
	, PPA_ORAL_PREZ_DT
	, PPA_ORAL_RESPONSE_SUBMITTED
	, PPA_RESPONSE_DUE_DT
	, PPA_WRITTEN_RESPONSE_SBMT_DT
	, PPA_POS_TITLE
	, PPA_PPLAN
	, PPA_SERIES
	, PPA_CURRENT_INFO_GRADE
	, PPA_CURRENT_INFO_STEP
	, PPA_PROPOSED_POS_TITLE
	, PPA_PROPOSED_PPLAN
	, PPA_PROPOSED_SERIES
	, PPA_PROPOSED_INFO_GRADE
	, PPA_PROPOSED_INFO_STEP
	, PPA_FINAL_POS_TITLE
	, PPA_FINAL_PPLAN
	, PPA_FINAL_SERIES
	, PPA_FINAL_INFO_GRADE
	, PPA_FINAL_INFO_STEP
	, PPA_NOTICE_ISSUED_DT
	, PPA_DEMO_FINAL_AGENCY_DECISION
	, PPA_DECIDING_OFFCL
	, PPA_DECISION_ISSUED_DT
	, PPA_DEMO_FINAL_AGENCY_EFF_DT
	, PPA_NUMB_DAYS
	, PPA_EFFECTIVE_DT
	, PPA_CURRENT_ADMIN_CODE
	, PPA_RE_ASSIGNMENT_CURR_ORG
	, PPA_FINAL_ADMIN_CODE
	, PPA_FINAL_ADMIN_CODE_FINAL_ORG
    , CASE WHEN PPA_ACTION_TYPE = 'Termination' and PPA_TERMINATION_TYPE = 'pre_emp' THEN PPA_TERM_EFFECTIVE_DECISION_DT
    WHEN PPA_ACTION_TYPE = 'Termination' and PPA_TERMINATION_TYPE = 'probation' THEN PPA_PROB_TERM_DCSN_ISSUED_DT    
    ELSE null END AS PPA_DATE_ACTION_TAKEN
FROM
	ERLR_PROB_ACTION PA
    LEFT OUTER JOIN ERLR_CASE EC ON PA.ERLR_CASE_NUMBER = EC.ERLR_CASE_NUMBER
;
/

CREATE OR REPLACE FORCE VIEW "HHS_CMS_HR"."VW_FISCAL_CALENDAR" (SVRID, DAYTYPE, DAYOFWEEK
        , CALDTIME, "FISCAL_YEAR", "FISCAL_YEAR_NAME", "FISCAL_QUARTER", "FISCAL_QUARTER_NAME") AS 

SELECT SVRID, DAYTYPE, DAYOFWEEK
          , CALDTIME
         , TO_CHAR(ADD_MONTHS(CALDTIME, 3), 'YYYY') AS FISCAL_YEAR
         , 'FY ' || TO_CHAR(ADD_MONTHS(CALDTIME, 3), 'YYYY') AS FISCAL_YEAR_NAME
         , TO_CHAR(ADD_MONTHS(CALDTIME, 3), 'Q') FISCAL_QUARTER
         , 'Q' || TO_CHAR(ADD_MONTHS(CALDTIME, 3), 'Q') FISCAL_QUARTER_NAME
FROM BIZFLOW.CAL
ORDER BY CALDTIME DESC;
/

GRANT SELECT ON HHS_CMS_HR.VW_FISCAL_CALENDAR TO HHS_CMS_HR_RW_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_FISCAL_CALENDAR TO HHS_CMS_HR_DEV_ROLE;
/


CREATE OR REPLACE VIEW HHS_CMS_HR.ADMIN_CODES AS 
SELECT
	ADMIN_CODE AS AC_ADMIN_CD,
	ADMIN_CODE_DESC AS AC_ADMIN_CD_DESCR,
	SUBSTR(ADMIN_CODE, 1, LENGTH(ADMIN_CODE) -1) AS AC_PARENT_CD
FROM HHS_HR.ADMINISTRATIVE_CODE
WHERE OPDIV = 'CMS'
AND ADMIN_CODE = 'F' OR ADMIN_CODE LIKE 'FC%';
/

COMMENT ON COLUMN HHS_CMS_HR.ADMIN_CODES.AC_ADMIN_CD IS 'Unique admin code';
COMMENT ON COLUMN HHS_CMS_HR.ADMIN_CODES.AC_ADMIN_CD_DESCR IS 'Description of admin code';
COMMENT ON COLUMN HHS_CMS_HR.ADMIN_CODES.AC_PARENT_CD IS 'Key value of associated parent admin code';	
/

GRANT SELECT ON HHS_CMS_HR.ADMIN_CODES TO HHS_CMS_HR_RW_ROLE;
GRANT SELECT ON HHS_CMS_HR.ADMIN_CODES TO HHS_CMS_HR_DEV_ROLE;
GRANT SELECT ON HHS_CMS_HR.ADMIN_CODES TO BF_DEV_ROLE;	
/

CREATE OR REPLACE VIEW VW_ERLR_APPEAL
AS
SELECT
    A.ERLR_CASE_NUMBER
    , EC.ERLR_JOB_REQ_NUMBER
    , EC.PROCID    
    , EC.ERLR_CASE_CREATE_DT
    , AP_ERLR_APPEAL_TYPE
	, A.AP_ERLR_APPEAL_FILE_DT
	, CASE WHEN A.AP_ERLR_APPEAL_TIMING = '1'  THEN 'Yes' ELSE 'No' END AS AP_ERLR_APPEAL_TIMING
	, CASE WHEN A.AP_APPEAL_HEARING_REQUESTED = '1'  THEN 'Yes' ELSE 'No' END AS AP_APPEAL_HEARING_REQUESTED
	, A.AP_ARBITRATOR_LAST_NAME
	, A.AP_ARBITRATOR_FIRST_NAME
	, A.AP_ARBITRATOR_MIDDLE_NAME
	, A.AP_ARBITRATOR_EMAIL
	, A.AP_ARBITRATOR_PHONE_NUM
	, A.AP_ARBITRATOR_ORG_AFFIL
	, A.AP_ARBITRATOR_MAILING_ADDR
	, A.AP_ERLR_PREHEARING_DT
	, A.AP_ERLR_HEARING_DT
	, A.AP_POSTHEARING_BRIEF_DUE
	, A.AP_FINAL_ARBITRATOR_DCSN_DT
	, CASE WHEN A.AP_ERLR_EXCEPTION_FILED = '1'  THEN 'Yes' ELSE 'No' END AS AP_ERLR_EXCEPTION_FILED
	, A.AP_ERLR_EXCEPTION_FILE_DT
	, A.AP_RESPON_TO_EXCEPT_DUE
	, A.AP_FINAL_FLRA_DECISION_DT
	, A.AP_ERLR_STEP_DECISION_DT
	, CASE WHEN A.AP_ERLR_ARBITRATION_INVOKED = '1'  THEN 'Yes' ELSE 'No' END AS AP_ERLR_ARBITRATION_INVOKED
	, A.AP_ARBITRATOR_LAST_NAME_3
	, A.AP_ARBITRATOR_FIRST_NAME_3
	, A.AP_ARBITRATOR_MIDDLE_NAME_3
	, A.AP_ARBITRATOR_EMAIL_3
	, A.AP_ARBITRATOR_PHONE_NUM_3
	, A.AP_ARBITRATOR_ORG_AFFIL_3
	, A.AP_ARBITRATION_MAILING_ADDR_3
	, A.AP_ERLR_PREHEARING_DT_2
	, A.AP_ERLR_HEARING_DT_2
	, A.AP_POSTHEARING_BRIEF_DUE_2
	, A.AP_FINAL_ARBITRATOR_DCSN_DT_2
	, CASE WHEN A.AP_ERLR_EXCEPTION_FILED_2 = '1'  THEN 'Yes' ELSE 'No' END AS AP_ERLR_EXCEPTION_FILED_2
	, A.AP_ERLR_EXCEPTION_FILE_DT_2
	, A.AP_RESPON_TO_EXCEPT_DUE_2
	, A.AP_FINAL_FLRA_DECISION_DT_2
	, A.AP_ARBITRATOR_LAST_NAME_2
	, A.AP_ARBITRATOR_FIRST_NAME_2
	, A.AP_ARBITRATOR_MIDDLE_NAME_2
	, A.AP_ARBITRATOR_EMAIL_2
	, A.AP_ARBITRATOR_PHONE_NUM_2
	, A.AP_ARBITRATOR_ORG_AFFIL_2
	, A.AP_ARBITRATION_MAILING_ADDR_2
	, A.AP_ERLR_PREHEARING_DT_SC
	, A.AP_ERLR_HEARING_DT_SC
	, A.AP_ARBITRATOR_LAST_NAME_4
	, A.AP_ARBITRATOR_FIRST_NAME_4
	, A.AP_ARBITRATOR_MIDDLE_NAME_4
	, A.AP_ARBITRATOR_EMAIL_4
	, A.AP_ARBITRATOR_PHONE_NUM_4
	, A.AP_ARBITRATOR_ORG_AFFIL_4
	, A.AP_ARBITRATOR_MAILING_ADDR_4
	, A.AP_DT_SETTLEMENT_DISCUSSION
	, A.AP_DT_PREHEARING_DISCLOSURE
    , A.AP_DT_AGNCY_FILE_RESPON_DUE
    , A.AP_ERLR_PREHEARING_DT_MSPB
	, CASE WHEN A.AP_WAS_DISCOVERY_INITIATED = '1'  THEN 'Yes' ELSE 'No' END AS AP_WAS_DISCOVERY_INITIATED
	, A.AP_ERLR_DT_DISCOVERY_DUE
	, A.AP_ERLR_HEARING_DT_MSPB
	, A.AP_PETITION_FILE_DT_MSPB
	, CASE WHEN A.AP_WAS_PETITION_FILED_MSPB = '1'  THEN 'Yes' ELSE 'No' END AS AP_WAS_PETITION_FILED_MSPB
	, A.AP_INITIAL_DECISION_DT_MSPB
	, A.AP_FINAL_BOARD_DCSN_DT_MSPB
	, A.AP_DT_SETTLEMENT_DISCUSSION_2
	, A.AP_DT_PREHEARING_DISCLOSURE_2
	, A.AP_DT_AGNCY_FILE_RESPON_DUE_2
	, A.AP_ERLR_PREHEARING_DT_FLRA
	, A.AP_ERLR_HEARING_DT_FLRA
	, A.AP_INITIAL_DECISION_DT_FLRA
	, CASE WHEN A.AP_WAS_PETITION_FILED_FLRA = '1'  THEN 'Yes' ELSE 'No' END AS AP_WAS_PETITION_FILED_FLRA
	, A.AP_PETITION_FILE_DT_FLRA
	, A.AP_FINAL_BOARD_DCSN_DT_FLRA

FROM
	ERLR_APPEAL A
    LEFT OUTER JOIN ERLR_CASE EC ON A.ERLR_CASE_NUMBER = EC.ERLR_CASE_NUMBER
;
/

CREATE OR REPLACE VIEW VW_ERLR_GRIEVANCE
AS
SELECT
    G.ERLR_CASE_NUMBER
    , EC.ERLR_JOB_REQ_NUMBER
    , EC.PROCID    
    , EC.ERLR_CASE_CREATE_DT
    , GI_TYPE
	, GI_NEGOTIATED_GRIEVANCE_TYPE
    , CASE WHEN GI_TYPE = 'Negotiated' and GI_NEGOTIATED_GRIEVANCE_TYPE = 'Individual' THEN GI_FILING_DT_2 ELSE GI_FILING_DT END AS GI_GRIEVANCE_FILED_DT
    , CASE WHEN GI_TYPE = 'Negotiated' and GI_NEGOTIATED_GRIEVANCE_TYPE = 'Individual' THEN GI_TIMELY_FILING_2 ELSE GI_TIMELY_FILING END AS GI_TIMELY_FILING
	, GI_IND_MANAGER
	, GI_IND_MEETING_DT
    , CASE WHEN GI_TYPE = 'Negotiated' and GI_NEGOTIATED_GRIEVANCE_TYPE = 'Individual' THEN GI_IND_DECISION_ISSUE_DT WHEN GI_TYPE = 'Administrative' THEN GI_ADMIN_STG_1_DECISION_DT ELSE null END AS GI_STEP_STAGE_1_DT
    , CASE WHEN GI_TYPE = 'Negotiated' and GI_NEGOTIATED_GRIEVANCE_TYPE = 'Individual' THEN GI_IND_STEP_2_DCSN_ISSUE_DT WHEN GI_TYPE = 'Administrative' THEN GI_ADMIN_STG_2_ISSUE_DT ELSE null END AS GI_STEP_STAGE_2_DT
	, GI_IND_STEP_1_DECISION_DT
    , GI_IND_STEP_1_DEADLINE
    , GI_IND_STEP_1_EXT_DUE_DT
    , GI_IND_STEP_1_EXT_DUE_REASON	
	, GI_STEP_2_REQUEST
	, GI_IND_STEP_2_MTG_DT
	, GI_IND_STEP_2_DECISION_DUE_DT	
	, GI_IND_STEP_2_DEADLINE
	, GI_IND_EXT_2_EXT_DUE_DT
	, GI_IND_STEP_2_EXT_DUE_REASON	
    , CASE WHEN GI_TYPE = 'Negotiated' and GI_NEGOTIATED_GRIEVANCE_TYPE = 'Individual' THEN G.GI_IND_THIRD_APPEAL_REQUEST 
    WHEN GI_TYPE = 'Negotiated' and GI_NEGOTIATED_GRIEVANCE_TYPE = 'Union' THEN G.GI_ARBITRATION_REQUEST 
    WHEN GI_TYPE = 'Negotiated' and GI_NEGOTIATED_GRIEVANCE_TYPE = 'Management' THEN G.GI_ARBITRATION_REQUEST 	
    ELSE null END AS GI_ARBITRATION_REQUEST
	, CASE WHEN GI_TYPE = 'Negotiated' and GI_NEGOTIATED_GRIEVANCE_TYPE = 'Individual' THEN G.GI_IND_THIRD_PARTY_APPEAL_DT 
    WHEN GI_TYPE = 'Negotiated' and GI_NEGOTIATED_GRIEVANCE_TYPE = 'Union' THEN G.GI_ARBITRATION_DEADLINE_DT 
    WHEN GI_TYPE = 'Negotiated' and GI_NEGOTIATED_GRIEVANCE_TYPE = 'Management' THEN G.GI_ARBITRATION_DEADLINE_DT 	
    ELSE null END AS GI_ARBITRATION_DEADLINE_DT	
    , GI_UM_GRIEVABILITY
	, GI_MEETING_DT
	, GI_GRIEVANCE_STATUS
	, GI_ADMIN_OFFCL_1	
	, GI_ADMIN_STG_1_ISSUE_DT
	, GI_ADMIN_STG_2_RESP
	, GI_ADMIN_OFFCL_2
	, GI_ADMIN_STG_2_DECISION_DT	
    , CASE WHEN GI_TYPE = 'Negotiated' THEN G.GI_GRIEVANCE_RELATED_2_PMAP_2 ELSE G.GI_GRIEVANCE_RELATED_2_PMAP END AS GI_GRIEVANCE_RELATED_2_PMAP
FROM
	ERLR_GRIEVANCE G
    LEFT OUTER JOIN ERLR_CASE EC ON G.ERLR_CASE_NUMBER = EC.ERLR_CASE_NUMBER;
 /

GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_COM TO HHS_CMS_HR_RW_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_COM TO BF_DEV_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_DATA TO HHS_CMS_HR_RW_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_DATA TO BF_DEV_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_LE TO HHS_CMS_HR_RW_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_LE TO BF_DEV_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_LE_CRED TO HHS_CMS_HR_RW_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_LE_CRED TO BF_DEV_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_PCA TO HHS_CMS_HR_RW_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_PCA TO BF_DEV_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_PDP TO HHS_CMS_HR_RW_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_PDP TO BF_DEV_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_SAM TO HHS_CMS_HR_RW_ROLE;
GRANT SELECT ON HHS_CMS_HR.VW_INCENTIVES_SAM TO BF_DEV_ROLE;
/

COMMIT;
/
